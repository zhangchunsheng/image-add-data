function MConstants(){}MConstants.ADD_MARKER="mass_add_marker";MConstants.NO_MARKER="mass_no_marker";
var MOUSE_CLICK="click",MOUSE_DBCLICK="dblclick",MOUSE_DOWN="mousedown",MOUSE_MOVING="mousemove",MOUSE_UP="mouseup",MOUSE_OVER="mouseover",MOUSE_OUT="mouseout",MOUSE_RIGHT_CLICK="contextmenu",MAP_MOVE_START="movestart",MAP_MOVING="move",MAP_MOVE_END="moveend",ZOOM_CHANGED="zoomchanged",ZOOM_START="zoomstart",ZOOM_END="zoomend",ADD_OVERLAY="featureadded",REMOVE_OVERLAY="featureremoved",CLEAR_OVERLAYS="featuresremoved",TIP_OPEN="popupopen",TIP_CLOSE="popupclose",ADD_TILELAYER="addlayer",MEASURE_STEP=
"MeasureStep",MEASURE_END="measureend",DRAG_START="dragstart",DRAGGING="drag",DRAG_END="dragend",MAP_READY="MapReady",ADD_MAPTYPE="AddMapType",REMOVE_MAPTYPE="RemoveMapType",TIP_BEFORE_CLOSE="TipBeforeClose",ON_MAP_MOVE="onMapMove",UPLOAD_PIC_COMPLETE="UploadPicComplete",COMPUTE_AREA_END="ComputeAreaEnd",OVERVIEWMAP_CHANGED="OverviewMapChanged",GPS_MOVEALONG_COMPLETE="GPSMoveAlongComplete",MENUITEM_CLICK="menuItemclick",ROLL_BACK="RollBack",ON_DRAG="onDrag",TOP_LEFT=1,TOP_CENTER=2,TOP_RIGHT=3,MIDDLE_LEFT=
4,MIDDLE_CENTER=5,MIDDLE_RIGHT=6,BOTTOM_LEFT=7,BOTTOM_CENTER=8,BOTTOM_RIGHT=9,NOFOCUS=-1,FOCUS=0,CENTER_FOCUS=1,OVERVIEW_CTRL="overviewCtrl",TOOLBAR_CTRL="navigationCtrl",SCALE_CTRL="scaleCtrl",MINIMIZE=0,SHOW=1,HIDE=2,DEFAULT=1,BLACK=2,MINI=4,SMALL=3,LINE_SOLID=0,LINE_DASHED=1,COORD_TYPE_ENCODE=0,COORD_TYPE_OFFSET=1,COORD_TYPE_GPS=2,DRAW_LINE="drawLineCtrl",DRAW_RECTANGLE="drawRectCtrl",DRAW_CIRCLE="drawCircleCtrl",DRAW_POLYGON="drawPolygonCtrl",DRAW_RULER="map_ruler",ADD_MARKER="addMarkerCtrl",
PAN_WHEELZOOM="pan_wheel",RULER="map_ruler",COMPUTE_AREA="computeAreaCrtl",FRAME_ZOOMIN="frameZoomIn",FRAME_ZOOMOUT="frameZoomOut",ISSTOP_HADLEMEASUR=false,TL_TRAFFIC="traffic_layer",TL_USERMAP="usermap_layer",TL_MASS_TRANSIT="satellite_layer",TL_SATELLITE="masstransit_layer",TL_REAL_ESTATE="realestate_layer",TL_CUSTOM_MAP="custommap_layer",EAST=-1,WEST=1,SOUTH=-1,NORTH=1,OPEN_OVERVIEW="1",CLOSE_OVERVIEW="0",HIDE_OVERVIEW="2";HTML_BUBBLE_TIP=1;HTML_CUSTOM_TIP=2;IMG_BUBBLE_TIP=3;UBAS_RETURN=null;
TYPE_MAP="Map";IMAGE_256="256";IMAGE_128="128";IMAGE_64="64";SLIDING_LINEAR="Linear";SLIDING_EXPO="Expo";SLIDING_QUAD="Quad";var MAMEValidateKeyFlag=true,MAMETenCentFlag=false;
function MAMEValidateUBAS(){var v=null;if(mValue_==0||mValue_==-1)v="";if(mValue_==1)v="\u60a8\u7684key\u88ab\u5f3a\u5236\u9501\u5b9a\uff0c\u8bf7\u60a8\u4e0eMapabc\u8054\u7cfb\uff01";if(mValue_==2)v="\u60a8\u7684api\u4f59\u989d\u4e0d\u8db3\uff0c\u8bf7\u60a8\u53ca\u65f6\u5145\u503c\uff01";if(mValue_==3)v="\u60a8\u7684api\u5df2\u7ecf\u5230\u671f\uff0c\u8bf7\u60a8\u4e0eMapabc\u8054\u7cfb\uff01";if(mValue_==4)v="\u5f15\u7528\u7684url\u9519\u8bef\uff0c\u8bf7\u60a8\u4e0ekey\u6838\u5bf9\u540e\u518d\u8bd5\uff01";
if(mValue_==5)v="\u5f15\u7528\u7684key\u9519\u8bef\uff0c\u8bf7\u60a8\u4e0eurl\u6838\u5bf9\u540e\u518d\u8bd5\uff01";if(mValue_==6)v="\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u60a8\u4e0eMapabc\u8054\u7cfb\uff01";return v}
function createErrorMessage(v,t,y){var p=new Mapabc.Pixel(v.getSize().w-(v.getSize().w-77),15);p=Mapabc.Util.createDiv("validateMessage",p,null);p.style.position="absolute";p.style.color="#f00";p.style.fontSize="12px";p.style.fontWeight="bold";p.style.zIndex=800;p.unselectable="on";if(y!="")p.innerHTML=""+y;else p.style.display="none";(new Mapabc.Events(this,p,null,true)).on({mousedown:v.onmousedown,mousemove:v.onmousemove,mouseup:v.onmouseup,mouseout:v.onmouseout,contextmenu:v.oncontextmenu,click:v.onclick});
t=Mapabc.Util.getElement(t);if(t.style.position==""){if(t.style.width=="100%"&&t.style.height=="100%"||t.style.width==""&&t.style.height==""){if(t.style.width=="")t.style.width="100%";if(t.style.height=="")t.style.height="100%";t.style.position="relative";if(document.all){y=document.createStyleSheet();y.addRule("html","width:100%;height:100%;margin:0;");y.addRule("body","width:100%;height:100%;margin:0;")}else{y=document.getElementsByTagName("HEAD").item(0);var k=document.createElement("style");k.type=
"text/css";k.innerHTML="html,body{ width:100%;height:100%;margin:0;}";y.appendChild(k)}}else{t.style.position="relative";if(document.all){y=document.createStyleSheet();if(t.style.width=="100%"){y.addRule("html","width:100%;margin:0;");y.addRule("body","width:100%;margin:0;")}else if(t.style.height=="100%"){y.addRule("html","height:100%;margin:0;");y.addRule("body","height:100%;margin:0;")}}else{y=document.getElementsByTagName("HEAD").item(0);k=document.createElement("style");k.type="text/css";if(t.style.width==
"100%")k.innerHTML="html,body{ width:100%;margin:0;}";else if(t.style.height=="100%")k.innerHTML="html,body{ height:100%;margin:0;}";y.appendChild(k)}}v.updateSize()}t.appendChild(p)}
function validate_ame(v,t){var y=MSISGetKey("ame.js");MSearchDummy.availabilityKey(y,false,2);setTimeout(function(){var p=MAMEValidateUBAS();if(p==""){if(p=Mapabc.Util.getElement(t)){if(p.style.width=="100%"&&p.style.height=="100%"||p.style.width==""&&p.style.height==""){if(p.style.width=="")p.style.width="100%";if(p.style.height=="")p.style.height="100%";p.style.position="relative";if(document.all){var k=document.createStyleSheet();k.addRule("html","width:100%;height:100%;margin:0;");k.addRule("body",
"width:100%;height:100%;margin:0;")}else{k=document.getElementsByTagName("HEAD").item(0);var u=document.createElement("style");u.type="text/css";u.innerHTML="html,body{ width:100%;height:100%;margin:0;}";k.appendChild(u)}}else{p.style.position="relative";if(document.all){k=document.createStyleSheet();if(p.style.width=="100%"){k.addRule("html","width:100%;margin:0;");k.addRule("body","width:100%;margin:0;")}else if(p.style.height=="100%"){k.addRule("html","height:100%;margin:0;");k.addRule("body",
"height:100%;margin:0;")}}else{k=document.getElementsByTagName("HEAD").item(0);u=document.createElement("style");u.type="text/css";if(p.style.width=="100%")u.innerHTML="html,body{ width:100%;margin:0;}";else if(p.style.height=="100%")u.innerHTML="html,body{ height:100%;margin:0;}";k.appendChild(u)}}Mapabc.Util.getBrowserName()=="firefox"&&v.updateSize()}}else createErrorMessage(v,t,p)},500)}
(function(){function v(a){for(var c="",b=document.getElementsByTagName("script").length,d=new RegExp(a,"gi"),e=0;e<b;e++){c=document.getElementsByTagName("script")[e].src;if(c.indexOf(a)!=-1){c=c.replace(d,",");c=c.split("?key=")[1];break}}return c}function t(a){document.write("<script src='"+a+"'><\/script>")}function y(a){if(a!=null&&a!="")return!isNaN(a);return false}function p(a){a=a.transform(q.getProjectionObject(),new Mapabc.Projection("EPSG:4326"));return new z(a.lon,a.lat,1)}function k(a){a=
new Mapabc.LonLat(a.lngX,a.latY);return a=a.transform(new Mapabc.Projection("EPSG:4326"),q.getProjectionObject())}function u(){}function g(a,c){m=this;c||(c=new u);this.zoom=parseInt(c.zoom);this.returnCoordType=c.returnCoordType;this.container=a;this.center=c.center;this.id="MAPABC_AME2_"+(new Date).getTime()+a;this.navigation=new Mapabc.Control.Navigation;this.keyboard=new Mapabc.Control.KeyboardDefaults;this.isExecMousemoveEvent=null;var b={projection:new Mapabc.Projection("EPSG:900913"),displayProjection:new Mapabc.Projection("EPSG:4326"),
units:"m",maxResolution:156543.0339,numZoomLevels:c.maxZoomLevel+1,controls:[this.navigation,this.keyboard],maxExtent:new Mapabc.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7)};this.map=q=new Mapabc.Map(a,b);this.map._MMAPABC_EVENT_MOUSEUP_=sa;if(c.minZoomLevel<3||c.minZoomLevel>c.maxZoomLevel)c.minZoomLevel=3;this.map.isContinuous=c.isContinuous;this.map.minZoomLevel=c.minZoomLevel;this.map.maxZoomLevel=c.maxZoomLevel;if(c.minZoomLevel>=this.zoom)this.zoom=c.minZoomLevel;if(this.zoom>=
this.map.maxZoomLevel)this.zoom=c.maxZoomLevel;this.map.returnCoordType=c.returnCoordType;b={};b.key=this.map.id;b.value=this;this.map.M_AMEMAP_ARRAY.push(b);this.map.div.oncontextmenu=function(){return false};this.map.ameMap=this;this.map.logoUrl=c.logoUrl?c.logoUrl:MAMETenCentFlag?'<a style="text-decoration:none;font-family:Arial,\u5b8b\u4f53;font-size:13px;color:#000" href="http://map.soso.com/" target="_blank">\u00a92010 Soso - Data\u00a9MapABC</a>':'<a style="text-decoration:none;font-family:Arial,\u5b8b\u4f53;font-size:13px;color:#000" href="http://www.mapabc.com/"  target="_blank">\u00a9 MapABC \u00a9 AutoNavi</a>';
this.mapnik=new Mapabc.Layer.TMS("\u00a9 AutoNavi \u00a9 MapABC.com",c.mapUrl?c.mapUrl:Mapabc_MAP_SERVER_URLS,{getURL:ta,buffer:0,displayOutsideMaxExtent:false,attribution:this.map.logoUrl});if(c.specifications==IMAGE_64)this.mapnik.setTileSize(new Mapabc.Size(64,64));else if(c.specifications==IMAGE_128)this.mapnik.setTileSize(new Mapabc.Size(128,128));else c.specifications==IMAGE_256&&this.mapnik.setTileSize(new Mapabc.Size(256,256));this.map.addLayer(this.mapnik);this.map.mapLayer=this.map.layerContainerDiv.childNodes[0];
l=new Mapabc.Layer.Vector("vector_layer",{zIndex:724});this.map.addLayer(l);C=new Mapabc.Layer.Markers("marker_layer",{zIndex:725});this.map.addLayer(C);P=new Mapabc.Layer.Boxes("Boxes",{zIndex:725});this.map.addLayer(P);this.modifyctrl=new Mapabc.Control.ModifyFeature(l,{arr:this.modifyfeatureArrById});this.map.addControl(new Mapabc.Control.Attribution);this.map.addControl(this.modifyctrl);b=new Mapabc.Pixel(c.toolbarPos.x,c.toolbarPos.y);if((c.maxZoomLevel!=17||c.minZoomLevel!=3)&&c.toolbar==DEFAULT)c.toolbar=
SMALL;if(c.toolbar==DEFAULT)this.map.addControl(new Mapabc.Control.PanZoomBar({id:"panZoom",position:b},MAMETenCentFlag));else if(c.toolbar==SMALL)this.map.addControl(new Mapabc.Control.PanZoom({id:"panZoom",position:b},MAMETenCentFlag));else c.toolbar==MINI&&this.map.addControl(new Mapabc.Control.PanZoom({id:"panZoom",isMINI:true,position:b},MAMETenCentFlag));c.scale==DEFAULT&&this.map.addControl(new Mapabc.Control.ScaleLine({id:"scaleline"}));if(c.overviewMap==DEFAULT||c.overviewMap==SHOW)this.map.addControl(new Mapabc.Control.OverviewMap({id:"overviewMap"}));
else if(c.overviewMap==MINIMIZE){this.map.addControl(new Mapabc.Control.OverviewMap({id:"overviewMap"}));this.setCtrlPanelState(OVERVIEW_CTRL,MINIMIZE)}if(this.zoom<3)this.zoom=3;if(!this.center||!(this.center instanceof z))this.center=new z("116.398","39.9082",1);this.map.setCenter(k(this.center),this.zoom);this.labelList=[];this.markerList=[];this.boxList=[];this.groundImagesList=[];this.lineList=[];this.rectList=[];this.polygonList=[];this.circeList=[];this.markerOptions=new ba;this.lineOptios=
new ca;this.areaOptions=new S;(this.zoomBox=c.zoomBox)&&this.magnifyingglassForMap();l.events.register("click",this.map,Ga);l.events.register("mousefeatureadded",this,ua);C.events.register("mousefeatureadded",this,ua);ga=new Mapabc.StyleMap;MAMEValidateKeyFlag&&validate_ame(this.map,a);this.addEventListener(this,MOUSE_CLICK,da);this.addEventListener(this,MAP_MOVE_START,da);this.addEventListener(this,MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_);this.map.defaultcenter=k(c.center);this.map.defaultzoom=
c.zoom;this.map.viewPortDiv.style.cursor="url('"+Mapabc._getScriptLocation()+"img/openhand.cur'), default";!MAMETenCentFlag&&c.hasDefaultMenu&&this.addDefultMenuItemForMap(Mapabc_AME_version)}function da(){m.menu&&m.menu.parentNode&&m.menu.parentNode.removeChild(m.menu)}function ta(a){var c=this.map.getResolution(),b=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w));a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));c=this.map.getZoom();b=MAMETenCentFlag?c+"/"+Math.floor(b/10)+"/"+Math.floor(a/10)+"/"+b+"_"+a+".gif":"&x="+b+"&y="+a+"&z="+c;a=this.url;if(a instanceof Array)a=this.selectUrl(b,a);return a+b}function ua(a){if(a.feature.CLASS_NAME=="Mapabc.Marker")a.sourceobj.MarkerToMMarker(a.feature);else if(a.feature)switch(a.feature.geometry.CLASS_NAME){case "Mapabc.Geometry.LineString":a.sourceobj.LineToMPolyline(a.feature);break;case "Mapabc.Geometry.Polygon":a.sourceobj.PolygonToMPolygon(a.feature);break;case "Mapabc.Geometry.Circle":a.sourceobj.CircleToMCircle(a.feature);
break}}function ma(a,c){this.layerType=a;this.option=c;if(!this.layerType)this.layerType=null;if(!this.option)this.option=null}function va(a){var c=this.map.getZoom();if(c>9){var b=this.map.getResolution();a="v=1.0&t=1&x="+Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w))+"&y="+Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h))+"&zoom="+(17-c);c=this.url;if(c instanceof Array)c=this.selectUrl(a,c);return c+a}else return null}function Ha(a){var c=this.map.getResolution(),b=Math.round((a.left-
this.maxExtent.left)/(c*this.tileSize.w));a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));b="&v=1.0&t=1&z="+(17-this.map.getZoom())+"&x="+b+"&y="+a;a=this.url;if(a instanceof Array)a=this.selectUrl(b,a);return a+b}function Ia(a){var c=this.map.getResolution(),b=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w));a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));c=this.map.getZoom();var d=this.url;d=d.replace("[z]",c);d=d.replace("[x]",b);return d=d.replace("[y]",a)}
function z(a,c,b){this.lngX=a;this.latY=c;b||(b=COORD_TYPE_OFFSET);if(b==COORD_TYPE_ENCODE){b={};b.lngX=a;b.latY=c;b=Mapabc.Util.getCoord(b);this.lngX=Number(b.lngX);this.latY=Number(b.latY)}else if(b==COORD_TYPE_OFFSET)if(!y(a)||!y(c)){b={};b.lngX=a;b.latY=c;b=Mapabc.Util.getCoord(b);this.lngX=Number(b.lngX);this.latY=Number(b.latY)}else{this.lngX=Number(a);this.latY=Number(c)}if(a instanceof Object)this.lngX=null;if(c instanceof Object)this.latY=null}function wa(a){this.lnglatArr=a}function H(a,
c){this.x=a;this.y=c}function Q(a,c){this.width=a;this.height=c;if(!a||!y(a))this.width=0;if(!c||!y(c))this.height=0}function R(a,c){this.southWest=a;this.northEast=c}function i(){i.instanceCount++;this.id="overlay"+i.instanceCount}function Y(a,c){this.base=i;this.base();this.TYPE=i.TYPE_AREA;this.lnglatArr=a;this.option=c}function J(a,c){this.base=i;this.base();this.TYPE=i.TYPE_RECTANGLE;this.lnglatArr=a;this.option=c?c:new S}function I(a,c){this.base=i;this.base();this.TYPE=i.TYPE_POLYLINE;this.lnglatArr=
a;this.option=c?c:new ca}function K(a,c){this.base=i;this.base();this.TYPE=i.TYPE_POLYGON;this.lnglatArr=a;this.option=c?c:new S}function E(a,c){this.base=i;this.base();this.TYPE=i.TYPE_MBOX;this.lnglat=a;this.option=c?c:new xa;this.size=new Q(0,0)}function xa(){this.content=null;this.boxAlign=8;this.zIndex_option=0;this.isEditable=false}function w(a,c){this.base=i;this.base();this.TYPE=i.TYPE_MARKER;this.lnglat=a;this.option=c?c:new ba;this.size=new Q(0,0)}function O(a,c){this.base=i;this.base();
this.TYPE=i.TYPE_LABEL;this.lnglat=a;this.option=c}function G(a,c,b){this.base=i;this.base();this.TYPE=i.TYPE_CIRCLE;this.radius=c;this.center=a;this.option=b?b:new S;this.bounds=new Mapabc.Bounds(0,0,0,0)}function U(a,c){this.base=i;this.base();this.TYPE=i.TYPE_GROUNDIMAGE;this.lnglat=a;this.option=c;this.size=new Q(0,0);this.bounds=new Mapabc.Bounds(0,0,0,0)}function M(a,c){this.maxX=c.x;this.maxY=c.y;this.minX=a.x;this.minY=a.y;this.topLeftPt=new H(this.minX,this.minY);this.rightBottomPt=new H(this.maxX,
this.maxY)}function ha(){this.borderStyle=new ea;this.borderStyle.alpha=1;this.borderStyle.color=22672;this.borderStyle.thickness=4;this.fillStyle=new ia;this.fillStyle.alpha=0.5;this.fillStyle.color=10728703}function Z(){this.name="\u5b8b\u4f53";this.size=12;this.color=22672;this.bold=false}function ea(){this.alpha=1;this.color=22672;this.thickness=2;this.lineType=LINE_SOLID}function ia(){this.alpha=1;this.color=13369440}function S(){this.areaStyle=new ha;this.tipOption=new ja;this.canShowTip=true;
this.isEditable=false;this.zoomLevels=[];this.labelOption=new na;this.labelStyle=new Z;this.isDimorphic=false;this.dimorphicColor=16711680;this.zIndex_option=0;this.rotateCenter=null;this.rotation=0;this.isRotate=false}function ca(){this.lineStyle=new ea;this.lineStyle.alpha=1;this.lineStyle.color=22672;this.lineStyle.thickness=4;this.tipOption=new ja;this.canShowTip=true;this.isEditable=false;this.zoomLevels=[];this.isDimorphic=false;this.dimorphicColor=16711680;this.zIndex_option=0;this.rotateCenter=
null;this.rotation=0;this.isRotate=false}function na(){this.fontStyle=new Z;this.content="";this.borderColor=22672;this.alpha=1;this.backgroundColor=16777215;this.zoomLevels=[];this.hasBackground=this.hasBorder=false;this.labelPosition=new H(0,0);this.labelAlign=TOP_LEFT}function ja(){this.title="";this.tipWidth="300px";this.tipHeight="0px";this.content="";this.tipType=HTML_BUBBLE_TIP;this.tipPosition=new H(0,0);this.hasShadow=true;this.alpha=1;this.borderStyle=new ea;this.borderStyle.thickness=2;
this.borderStyle.color=23733;this.titleFontStyle=new Z;this.titleFontStyle.size=14;this.titleFontStyle.bold=true;this.titleFontStyle.color=16777215;this.contentFontStyle=new Z;this.contentFontStyle.color=19089;this.fillStyle=new ia;this.fillStyle.color=16777215;this.titleFillStyle=new ia;this.titleFillStyle.color=23733;this.roundRectSize=15;this.offset=null;this.tipAlign=8}function ba(){this.imageUrl=Mapabc._getScriptLocation()+"img/lan_1.png";this.anchor=this.offset=this.imageSize=null;this.label=
"";this.labelStyle=new Z;this.dragHeight=null;this.bouncy=false;this.bouncyGravity=1;this.gravity=null;this.imageAlign=BOTTOM_CENTER;this.tipOption=new ja;this.canShowTip=true;this.rotation=0;this.isEditable=false;this.picAgent=this.hasShadow=true;this.zoomLevels=[];this.isDimorphic=false;this.dimorphicColor=16711680;this.labelOption=null;this.zIndex_option=0}function A(a,c,b){var d=[];if(c=="feature"){c=0;for(var e=a.length;c<e;c++){a[c].vector&&m.unSelectFeature(a[c].vector,b);d.push(a[c].vector)}}else if(c==
"overlay"){c=0;for(e=a.length;c<e;c++)d.push(a[c].overlay)}return d}function ya(a){var c=a.units;B&&l.addFeatures(B);if(a.units==="m")c="\u7c73";else if(a.units==="km")c="\u516c\u91cc";if(fa=="polygon")c="\u5e73\u65b9"+c;if(B){B.style.label=a.measure+" "+c;B.move(new Mapabc.LonLat(a.point.x,a.point.y))}ISSTOP_HADLEMEASUR=false}function za(a){var c=a.measure,b=a.feature.id,d=a.feature.geometry.components[a.feature.geometry.components.length-1];d=p(new Mapabc.LonLat(d.x,d.y));var e={};e.id=a.feature.id;
e.vector=a.feature;e.label=B;a.geometry.CLASS_NAME=="Mapabc.Geometry.LineString"?T.push(e):N.push(e);e=a.units;if(a.units==="m")e="\u7c73";else if(a.units==="km")e="\u516c\u91cc";if(fa=="polygon")e="\u5e73\u65b9"+e;B=null;ISSTOP_HADLEMEASUR=true;a={};a.mapId=q.id;a.eventType="MeasureEnd";a.overlayId=b;a.eventX=d.lngX;a.eventY=d.latY;a.measureResult=c+" "+e;this.map.events.triggerEvent("measureend",a)}function Aa(a){if(B==null){var c=a.point.clone(),b=a.units;if(a.units==="m")b="\u7c73";else if(a.units===
"km")b="\u516c\u91cc";if(fa=="polygon")b="\u5e73\u65b9"+b;B=new Mapabc.Feature.Vector(c,null,{pointRadius:0,pointerEvents:"visiblePainted",label:a.measure+" "+b,fontWeight:"bold",labelAlign:"lt"});l.addFeatures(B)}}function Ba(a,c,b,d){b=180*b/(Math.PI*d);return new z(a.lngX+180*c/(Math.PI*d*Math.cos(a.latY*Math.PI/180)),a.latY+b,1)}function oa(a){if(!a.option)a.option=this.areaOptions;var c=a.option,b=Math.pow(Math.pow(a.radius,2)/2,0.5),d=k(Ba(a.center,b,b,6378137));b=k(a.center);var e=(Math.abs(d.lat-
b.lat)+Math.abs(d.lon-b.lon))/2;d={strokeColor:x(c.areaStyle.borderStyle.color),strokeOpacity:c.areaStyle.borderStyle.alpha,strokeWidth:c.areaStyle.borderStyle.thickness,fillColor:x(c.areaStyle.fillStyle.color),fillOpacity:c.areaStyle.fillStyle.alpha,pointRadius:e,pointerEvents:"visiblePainted",zIndex:a.option.zIndex_option};if(c.labelOption&&c.labelOption.content.trim()!=""){d.label=c.labelOption.content;d.fontColor=x(c.labelOption.fontStyle.color);d.fontSize=c.labelOption.fontStyle.size;d.fontFamily=
c.labelOption.fontStyle.name;if(c.labelOption.fontStyle.bold)d.fontWeight="bold";d.labelAlign=Mapabc.Util.getStringAling(c.labelOption.labelAlign);d.labelPosition=c.labelOption.labelPosition}c=new Mapabc.Geometry.Circle(b.lon,b.lat,e);c.id=a.id;c=new Mapabc.Feature.Vector(c,null,d);c.id=a.id;return c}function pa(a){var c=k(a.lnglatArr[0]),b=k(a.lnglatArr[1]);if(!a.option)a.option=this.areaOptions;var d=a.option,e={strokeColor:x(d.areaStyle.borderStyle.color),strokeOpacity:d.areaStyle.borderStyle.alpha,
strokeWidth:d.areaStyle.borderStyle.thickness,fillColor:x(d.areaStyle.fillStyle.color),fillOpacity:d.areaStyle.fillStyle.alpha,pointRadius:6,pointerEvents:"visiblePainted",zIndex:a.option.zIndex_option};if(d.labelOption&&d.labelOption.content.trim()!=""){e.label=d.labelOption.content;e.fontColor=x(d.labelOption.fontStyle.color);e.fontSize=d.labelOption.fontStyle.size;e.fontFamily=d.labelOption.fontStyle.name;if(d.labelOption.fontStyle.bold)e.fontWeight="bold";e.labelAlign=Mapabc.Util.getStringAling(d.labelOption.labelAlign);
e.labelPosition=d.labelOption.labelPosition}c=(new Mapabc.Bounds(c.lon,c.lat,b.lon,b.lat)).toGeometry();c.isRectangle=true;e=new Mapabc.Feature.Vector(c,null,e);e.id=a.id;return e}function qa(a){var c=new Mapabc.Geometry.LinearRing(Ca(a.lnglatArr));c=new Mapabc.Geometry.Polygon([c]);if(!a.option)a.option=this.areaOptions;var b=a.option,d={strokeColor:x(b.areaStyle.borderStyle.color),strokeOpacity:b.areaStyle.borderStyle.alpha,strokeWidth:b.areaStyle.borderStyle.thickness,fillColor:x(b.areaStyle.fillStyle.color),
fillOpacity:b.areaStyle.fillStyle.alpha,pointRadius:6,pointerEvents:"visiblePainted",zIndex:a.option.zIndex_option};if(b.labelOption&&b.labelOption.content.trim()!=""){d.label=b.labelOption.content;d.fontColor=x(b.labelOption.fontStyle.color);d.fontSize=b.labelOption.fontStyle.size;d.fontFamily=b.labelOption.fontStyle.name;if(b.labelOption.fontStyle.bold)d.fontWeight="bold";d.labelAlign=Mapabc.Util.getStringAling(b.labelOption.labelAlign);d.labelPosition=b.labelOption.labelPosition}c.id=a.id;c=new Mapabc.Feature.Vector(c,
null,d);c.id=a.id;return c}function Ga(a){if(l.getFeatureFromEvent(a)){var c=l.getFeatureFromEvent(a).id,b=m.getOverlayById(c);if(b){c=b.option;if(c.canShowTip){var d=l.getFeatureFromEvent(a),e=null;e=b instanceof w?new Mapabc.LonLat(d.geometry.x,d.geometry.y):a.layerX?q.getLonLatFromPixel(new Mapabc.Pixel(a.layerX,a.layerY)):q.getLonLatFromPixel(new Mapabc.Pixel(a.x,a.y));a={};a.width=parseInt(d.style.graphicWidth)/2;a.height=parseInt(d.style.graphicHeight);a.map=q;$(d.id,e,c.tipOption,true,true,
a)}}}}function ra(a){var c=null;if(!a.option)a.option=this.lineOptios;c=a.option;var b=new Mapabc.Geometry.LineString(Ca(a.lnglatArr)),d={strokeColor:x(c.lineStyle.color),strokeOpacity:c.lineStyle.alpha,strokeWidth:c.lineStyle.thickness,pointRadius:6,pointerEvents:"visiblePainted",zIndex:a.option.zIndex_option};d.strokeDashstyle=c.lineStyle.lineType==LINE_DASHED?"dash":"Solid";b.id=a.id;c=new Mapabc.Feature.Vector(b,null,d);c.id=a.id;return c}function x(a){a=a.toString(16);switch(a.length){case 0:a=
"#000000";break;case 1:a="#00000"+a;break;case 2:a="#0000"+a;break;case 3:a="#000"+a;break;case 4:a="#00"+a;break;case 5:a="#0"+a;break;case 6:a="#"+a}return a}function $(a,c,b,d,e,f){if(b)if(!(b.title==""&&b.content=="")){da();d=m.getOverlayById(a,"overlay");if(d instanceof w)var n="_MARKER_";else if(d instanceof I)n="_POLYLINE_";else if(d instanceof K)n="_POLYGON_";else if(d instanceof J)n="_RECTANGLE_";else if(d instanceof G)n="_Circle_";if(s==null){s=new Mapabc.Popup.FramedCloud("popup",c,null,
b,null,true,undefined,f,r,a,n);q.addPopup(s,true);s.overlayType=n;s.overlay=d;s.tipType=b.tipType;d?s.div.setAttribute("jsoverlayid",d.id):s.div.setAttribute("jsoverlayid","")}else{s.overlayId=a;s.overlay=d;s.lonlat=c;s.tipOption=b;s.overlayType=n;if(f)if(!isNaN(f.height))s.offset=f;s.setContentHTML(true,n,b.tipType);s.tipType=b.tipType;d?s.div.setAttribute("jsoverlayid",d.id):s.div.setAttribute("jsoverlayid","");s.visible()||s.toggle()}if(b.tipType==3)if(c=document.getElementById("popup_close"))c.onclick=
function(){m.closeTip()};c={};c.mapId=q.id;c.eventType="popupopen";c.overlayId=a;q.events.triggerEvent("popupopen",c);Ja(s);Ka=a}}function Ja(a){if(a.tipOption.tipType==1){var c=a.contentDiv.offsetWidth+5+"px";a._THBorder.style.width=c;a._BHBorder.style.width=c;a._THBorder.style.marginTop="-"+(parseInt(a.contentDiv.offsetHeight)+29+10)+"px";a._BHBorder.style.marginTop=parseInt(a.contentDiv.offsetHeight)+25+9+"px";c=c;var b=a.tipOption.tipHeight}else if(a.tipOption.tipType==2)if(a.div.firstChild){c=
a.div.firstChild.style.width;b=a.div.firstChild.style.height}else{c=a.tipOption.tipWidth;b=a.tipOption.tipHeight}else if(a.tipOption.tipType==3){c=a.tipOption.tipWidth;b=a.tipOption.tipHeight}a.setSize(new Mapabc.Size(c,b));a.panIntoView()}function ka(a){a=a.element.id;var c=Mapabc.Util.getElement(a),b=m.getOverlayById(a,"overlay");m.getOverlayById(a,"vector");if(!b.option.anchor)b.option.anchor=new H(0,0);var d={};d.width=parseInt(c.offsetWidth);d.height=parseInt(c.offsetHeight);d.map=q;d.anchor=
b.option.anchor;d.imageAlign=b.option.imageAlign;if(isNaN(b.lnglat.lngX)||isNaN(b.lnglat.latY))b.lnglat=Mapabc.Util.getCoord(b.lnglat);c=k(b.lnglat);$(a,c,b.option.tipOption,true,true,d)}function la(a){var c=q.getAmeMapObj(q.id);a=m.getOverlayById(a.overlayId,"overlay");c.saveOverlay=a;c.saveOverlay._jstype_="drag";if(c.isExecMousemoveEvent==null){c.map.events.register(MOUSE_MOVING,c.map,q._MMAPABC_EVENT_MOUSEMOVE_);c.isExecMousemoveEvent=1}}function sa(){var a=q.getAmeMapObj(q.id);a.map.events.unregister(MOUSE_MOVING,
a.map,q._MMAPABC_EVENT_MOUSEMOVE_);a.isExecMousemoveEvent=null}function aa(a,c){m.menuItems=[];for(var b=0;b<c.length;b++){var d=c[b].menuItem;if(d.overlayIds instanceof Array)for(var e=0;e<d.overlayIds.length;e++){if(a.overlayId==d.overlayIds[e]){var f={};f.id=d.id;f.menuText=d.menuText;f.functionName=d.functionName;f.objectType=c[b].type;f.overlayId=a.overlayId;f.isEnabled=d.isEnabled;f.isHaveSeparator=d.isHaveSeparator;m.menuItems.push(f)}}else if(d.overlayIds){if(a.overlayId==d.overlayIds){f=
{};f.id=d.id;f.menuText=d.menuText;f.functionName=d.functionName;f.objectType=c[b].type;f.overlayId=a.overlayId;f.isEnabled=d.isEnabled;f.isHaveSeparator=d.isHaveSeparator;m.menuItems.push(f)}}else{f={};f.id=d.id;f.menuText=d.menuText;f.functionName=d.functionName;f.objectType=c[b].type;f.overlayId=a.overlayId;f.isEnabled=d.isEnabled;f.isHaveSeparator=d.isHaveSeparator;m.menuItems.push(f)}}m.createMenuDiv(m.menuItems,a.lnglat)}function Da(a){var c={},b=m.getOverlayById(a.overlayId),d=a.overlayId;
if(b==null)if(a.object){b=m.getOverlayById(a.object.id);d=a.object.id;a=b.lnglat}else{d=m.map.id;a=new z(a.eventX,a.eventY)}else a=new z(a.eventX,a.eventY);c.overlay=b;c.overlayId=d;c.lnglat=a;return c}function Ea(){this.id=null;this.objectType=TYPE_MAP;this.overlayIds=null;this.order=0;this.menuText="";this.functionName=null;this.isEnabled=true;this.isHaveSeparator=false}function Ca(a){for(var c=[],b=0;b<a.length;b++){var d=k(a[b]);d=new Mapabc.Geometry.Point(d.lon,d.lat);c.push(d)}return c}function Fa(a){for(var c=
[],b=0;b<a.length;b++){var d=p(new Mapabc.LonLat(a[b].x,a[b].y));c.push(d)}return c}function L(a){if(Mapabc.Util.getBrowserName()=="msie"){if(a.srcElement)var c=m.getOverlayById(a.srcElement.id)}else if(Mapabc.Util.getBrowserName()=="firefox")if(a.target)c=m.getOverlayById(a.target.id);if(c)if(c instanceof I||c instanceof K||c instanceof J||c instanceof G||c instanceof O)return;for(var b in r){c=q.getAmeMapObj(q.id);if(r[b].type!="dblclick"){if(a.type==r[b].type){var d=a;if(a.type=="click"){d={};
d.mapId=q.id;d.eventType=a.type.replace("click","Click");d.eventType=d.eventType.replace("db","Db");d.eventType="Mouse"+d.eventType;d.overlayId="";var e=W(a.xy.x,a.xy.y);if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}d.eventX=e.lngX;d.eventY=e.latY}else if(a.type.indexOf("mouse")!=-1){d={};d.mapId=q.id;d.eventType=a.type.replace("m","M");d.eventType=d.eventType.replace("over","Over");d.eventType=
d.eventType.replace("out","Out");d.eventType=d.eventType.replace("up","Up");d.eventType=d.eventType.replace("move","Moving");d.eventType=d.eventType.replace("do","Do");d.overlayId="";e=W(a.xy.x,a.xy.y);if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}if(d.eventType!="MouseOver"&&d.eventType!="MouseOut"){d.eventX=e.lngX;d.eventY=e.latY}else return}else if(a.type.indexOf("feature")!=-1){d={};
d.mapId=q.id;d.eventType="AddOverlay";if(a.type==REMOVE_OVERLAY)d.eventType="RemoveOverlay";if(a.feature)d.overlayId=a.feature.id;if(a.type==CLEAR_OVERLAYS)d.eventType="ClearOverlays"}else if(a.type.indexOf("zoom")!=-1){d={};d.mapId=q.id;d.eventType=a.type.replace("zo","Zo");d.eventType=d.eventType.replace("st","St");d.eventType=d.eventType.replace("ch","Ch");d.eventType=d.eventType.replace("end","End");e=p(q.center.clone());if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=
Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}d.eventX=e.lngX;d.eventY=e.latY;d.zoom=q.zoom}else if(a.type.indexOf("move")!=-1){d={};d.mapId=q.id;if(a.type=="move")d.eventType="MapMoving";else{e=a.type.replace("m","M");e=e.replace("s","S");e=e.replace("en","En");d.eventType="Map"+e}e=p(a.object.center.clone());if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}d.eventX=
e.lngX;d.eventY=e.latY}else if(a.type.indexOf("layer")!=-1){d={};d.mapId=q.id;d.eventType=a.type;d.tileLayerId=a.layer.id}else if(a.type.indexOf("popupopen")!=-1||a.type.indexOf("popupclose")!=-1){if(Mapabc.Util.getElement("popup")){d={};d.mapId=q.id;if(a.type.indexOf("popupopen")!=-1)d.eventType="TipOpen";else if(a.type.indexOf("popupclose")!=-1)d.eventType="TipClose";d.overlayId=a.overlayId}}else if(a.type.indexOf("contextmenu")!=-1){d={};d.mapId=q.id;d.eventType=a.type.replace(a.type,"MouseRightClick");
d.overlayId="";e=W(a.xy.x,a.xy.y);if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}d.eventX=e.lngX;d.eventY=e.latY}else if(a.type.indexOf("menuItemclick")!=-1){d={};d.mapId=q.id;d.eventType=a.type.replace(a.type,"MenuItemClick");d.overlayId=a.overlayId==q.id?"":a.overlayId;d.menuItemId=a.menuItemId;d.objectType=a.objectType;if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.xy.lngX)||!isNaN(a.xy.latY)){a.xy.lngX=
Mapabc.Util.encodeNumber(a.xy.lngX,0);a.xy.latY=Mapabc.Util.encodeNumber(a.xy.latY,0)}d.eventX=a.xy.lngX;d.eventY=a.xy.latY}else if(a.type=="dragstart"){d={};d.mapId=q.id;d.eventType=a.type.replace(a.type,"DragStart");d.overlayId="";if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.eventX)||!isNaN(a.eventY)){a.eventX=Mapabc.Util.encodeNumber(a.eventX,0);a.eventY=Mapabc.Util.encodeNumber(a.eventY,0)}d.eventX=a.eventX;d.eventY=a.eventY}else if(a.type=="drag"){d={};d.mapId=q.id;d.eventType=a.type.replace(a.type,
"Dragging");d.overlayId="";if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.eventX)||!isNaN(a.eventY)){a.eventX=Mapabc.Util.encodeNumber(a.eventX,0);a.eventY=Mapabc.Util.encodeNumber(a.eventY,0)}d.eventX=a.eventX;d.eventY=a.eventY}else if(a.type=="dragend"){d={};d.mapId=q.id;d.eventType=a.type.replace(a.type,"DragEnd");d.overlayId="";if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.eventX)||!isNaN(a.eventY)){a.eventX=Mapabc.Util.encodeNumber(a.eventX,0);a.eventY=Mapabc.Util.encodeNumber(a.eventY,
0)}d.eventX=a.eventX;d.eventY=a.eventY}r[b].func.apply(r[b].obj,[d])}}else if(r[b].type=="dblclick"){d={};d.mapId=q.id;d.eventType="dblclick";e=a.layerX?W(a.layerX,a.layerY):W(a.x,a.y);if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}d.eventX=e.lngX;d.eventY=e.latY}}}function W(a,c){return p(q.getLonLatFromPixel(new Mapabc.Pixel(a,c)))}function V(a){var c=q.getAmeMapObj(q.id),b=a.type!="menuItemclick"?
l.getFeatureFromEvent(a):c.getOverlayById(a.overlayId);if(b)for(var d in j){if(a.type==j[d].type&&j[d].id==b.id){obj={};obj.mapId=q.id;obj.eventType=a.type;if(obj.eventType=="click")obj.eventType="MouseClick";else{obj.eventType=obj.eventType.replace("m","M");obj.eventType=obj.eventType.replace("c","C")}obj.eventType=obj.eventType.replace("over","Over");obj.eventType=obj.eventType.replace("out","Out");obj.eventType=obj.eventType.replace("up","Up");obj.eventType=obj.eventType.replace("move","Moving");
obj.eventType=obj.eventType.replace("do","Do");if(obj.eventType=="ContextMenu")obj.eventType="MouseRightClick";obj.overlayId=b.id;var e;if(obj.eventType!="MenuItemClick")e=a.layerX?W(a.layerX,a.layerY):W(a.x,a.y);else{e=a.xy;obj.menuItemId=a.menuItemId;obj.objectType=a.objectType}if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.lngX)||!isNaN(e.latY)){e.lngX=Mapabc.Util.encodeNumber(e.lngX,0);e.latY=Mapabc.Util.encodeNumber(e.latY,0)}obj.eventX=e.lngX;obj.eventY=e.latY;j[d].func.apply(j[d].obj,
[obj])}}else for(d in j)if(a.object)if(a.type==j[d].type&&j[d].id==a.object.id)if(b=m.getOverlayById(a.object.id)){obj={};obj.mapId=q.id;obj.eventType=a.type;if(obj.eventType=="click")obj.eventType="MouseClick";else{obj.eventType=obj.eventType.replace("m","M");obj.eventType=obj.eventType.replace("c","C")}obj.eventType=obj.eventType.replace("over","Over");obj.eventType=obj.eventType.replace("out","Out");obj.eventType=obj.eventType.replace("up","Up");obj.eventType=obj.eventType.replace("move","Moving");
obj.eventType=obj.eventType.replace("do","Do");if(obj.eventType=="ContextMenu")obj.eventType="MouseRightClick";obj.overlayId=a.object.id;if(c.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.lnglat.lngX)||!isNaN(b.lnglat.latY)){b.lnglat.lngX=Mapabc.Util.encodeNumber(b.lnglat.lngX,0);b.lnglat.latY=Mapabc.Util.encodeNumber(b.lnglat.latY,0)}obj.eventX=b.lnglat.lngX;obj.eventY=b.lnglat.latY;j[d].func.apply(j[d].obj,[obj])}}var X=function(a){var c="";a=new RegExp("(^|(.*?\\/))("+a+")(\\?|$)");for(var b=
document.getElementsByTagName("script"),d=0,e=b.length;d<e;d++){var f=b[d].getAttribute("src");if(f)if(f=f.match(a)){c=f[1];break}}return c}("ame.js");X.substr(0,X.length-6);t(X+"Mapabc.js");t(X+"Profile.js");t(X+"mapTools.js");t(X+"validateKey.js");t(X+"asa.js?key="+v("ame.js"));u.prototype.zoom=3;u.prototype.toolbar=null;u.prototype.overviewMap=null;u.prototype.center=new z("116.398","39.9082",1);u.prototype.toolbarPos=new H(10,10);u.prototype.isCongruence=true;u.prototype.scale=null;u.prototype.zoomBox=
true;u.prototype.returnCoordType=COORD_TYPE_OFFSET;u.prototype.logoUrl=null;u.prototype.minZoomLevel=3;u.prototype.maxZoomLevel=17;u.prototype.mapUrl=null;u.prototype.specifications=IMAGE_256;u.prototype.isContinuous=false;u.prototype.hasDefaultMenu=true;var m;g.prototype.saveOverlay=null;g.prototype.map=null;g.prototype.zoom=3;g.prototype.labelList=null;g.prototype.markerList=null;g.prototype.groundImagesList=null;g.prototype.boxList=null;g.prototype.lineList=null;g.prototype.rectList=null;g.prototype.polygonList=
null;g.prototype.circeList=null;g.prototype.drawfeatureCtrl=null;g.prototype.mousLayer=null;g.prototype.navigation=null;g.prototype.keyboard=null;g.prototype.popup=null;g.prototype.modifyctrl=null;g.prototype.modifyfeatureArrById=[];g.prototype.menuArrId_map=[];g.prototype.markerOptions=null;g.prototype.lineOptios=null;g.prototype.areaOptions=null;g.prototype.menuItemsObj_map=[];g.prototype.menuItemsObj_marker=[];g.prototype.menuItemsObj_box=[];g.prototype.menuItemsObj_polyline=[];g.prototype.menuItemsObj_polygon=
[];g.prototype.menuItemsObj_rect=[];g.prototype.menuItemsObj_circle=[];g.prototype.menuItemsIds=null;g.prototype.menuItems=null;g.prototype.menu=null;g.prototype.overlayIds=[];g.prototype.addMenuitemlogarr=[];g.prototype.isoverlayofmenu=true;g.prototype.OverlayEventList=null;var q,l,C,P,ga;g.prototype.addDefultMenuItemForMap=function(a){var c=[],b=new Ea;b.id="version";b.objectType=TYPE_MAP;b.order=1E4;b.menuText=a;b.isEnabled=true;b.isHaveSeparator=true;b.functionName=function(){window.open("http://www.mapabc.com")};
c.push(b);this.addMenuItems(c)};g.prototype.destroy=function(){for(var a=0,c=r.length;a<c;a++)if(r[a])if(r[a].mapObj)if(r[a].mapObj.map.events){if(r[a].type.indexOf("feature")!=-1||r[a].type.indexOf("click")!=-1||r[a].type.indexOf("down")!=-1)l.events.unregister(r[a].type,r[a].mapObj,L)}else this.map.events.unregister(r[a].type,r[a].mapObj,L);a=0;for(c=j.length;a<c;a++)j[a]&&j[a].mapObj&&l.events.unregister(j[a].type,j[a].obj,V);r=[];j=[];this.map.destroy()};g.prototype.clearMap=function(){this.removeAllOverlays();
this.removeTileLayer("ALL");var a=document.getElementById("MapTool_MoreMapDiv");a&&a.parentNode.removeChild(a)};g.prototype.unSelectFeature=function(a,c){s&&s.overlayType==c&&this.modifyctrl.unselectFeature(a)};g.prototype.MarkerToMMarker=function(a){var c=new ba;c=new w(p(a.lonlat.clone()),c);c.id=a.id;var b={};b.id=c.id;b.vector=a;b.overlay=c;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.overlay.lnglat.lngX)||!isNaN(b.overlay.lnglat.latY)){b.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(b.overlay.lnglat.lngX,
0);b.overlay.lnglat.latY=Mapabc.Util.encodeNumber(b.overlay.lnglat.latY,0)}this.markerList.push(b)};g.prototype.PolygonToMPolygon=function(a){var c=a.geometry,b=ga.createSymbolizer(a,a.renderIntent),d=new ha;d.borderStyle.alpha=b.strokeOpacity;d.borderStyle.color=b.strokeColor;d.borderStyle.thickness=b.strokeWidth;d.fillStyle.alpha=b.fillOpacity;d.fillStyle.color=b.fillColor;if(b.label){d.labelOption.content=b.label;d.labelOption.fontStyle.color=b.fontColor;d.labelOption.fontStyle.size=b.fontSize;
d.labelOption.fontStyle.name=b.fontFamily}b=new S;b.areaStyle=d;lnglatarr=Fa(a.geometry.components[0].components);if(c.isRectangle){d=new J([lnglatarr[0],lnglatarr[2]],b);d.id=a.id;c={};c.id=d.id;c.vector=a;c.overlay=d;if(this.returnCoordType==COORD_TYPE_ENCODE)for(a=0;a<c.overlay.lnglatArr.length;a++)if(!isNaN(c.overlay.lnglatArr[a].lngX)||!isNaN(c.overlay.lnglatArr[a].latY)){c.overlay.lnglatArr[a].lngX=Mapabc.Util.encodeNumber(c.overlay.lnglatArr[a].lngX,0);c.overlay.lnglatArr[a].latY=Mapabc.Util.encodeNumber(c.overlay.lnglatArr[a].latY,
0)}this.rectList.push(c)}else{d=new K(lnglatarr,b);d.id=a.id;c={};c.id=d.id;c.vector=a;c.overlay=d;if(this.returnCoordType==COORD_TYPE_ENCODE)for(a=0;a<c.overlay.lnglatArr.length;a++)if(!isNaN(c.overlay.lnglatArr[a].lngX)||!isNaN(c.overlay.lnglatArr[a].latY)){c.overlay.lnglatArr[a].lngX=Mapabc.Util.encodeNumber(c.overlay.lnglatArr[a].lngX,0);c.overlay.lnglatArr[a].latY=Mapabc.Util.encodeNumber(c.overlay.lnglatArr[a].latY,0)}this.polygonList.push(c)}};g.prototype.CircleToMCircle=function(a){var c=
ga.createSymbolizer(a,a.renderIntent),b=new ha;b.borderStyle.alpha=c.strokeOpacity;b.borderStyle.color=c.strokeColor;b.borderStyle.thickness=c.strokeWidth;b.fillStyle.alpha=c.fillOpacity;b.fillStyle.color=c.fillColor;if(c.label){b.labelOption.content=c.label;b.labelOption.fontStyle.color=c.fontColor;b.labelOption.fontStyle.size=c.fontSize;b.labelOption.fontStyle.name=c.fontFamily}c=new S;c.areaStyle=b;var d=a.geometry;b=new Mapabc.Geometry.Point(d.x,d.y);d=new Mapabc.Geometry.Point(b.x+d.radius,b.y);
b=new Mapabc.Geometry.LineString([b,d]);c=new G(p(new Mapabc.LonLat(a.geometry.x,a.geometry.y)),b.getGeodesicLength(this.map.getProjectionObject())/2,c);c.id=a.id;b=p(new Mapabc.LonLat(a.geometry.bounds.left-a.geometry.radius,a.geometry.bounds.bottom-a.geometry.radius));d=p(new Mapabc.LonLat(a.geometry.bounds.right+a.geometry.radius,a.geometry.bounds.top+a.geometry.radius));b=new R(new z(b.lngX,b.latY),new z(d.lngX,d.latY));if(this.map.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.southWest.lngX)||
!isNaN(b.northEast.lngX)||!isNaN(b.southWest.lngY)||!isNaN(b.northEast.latY)){b.southWest.lngX=Mapabc.Util.encodeNumber(b.southWest.lngX,0);b.southWest.latY=Mapabc.Util.encodeNumber(b.southWest.latY,0);b.northEast.lngX=Mapabc.Util.encodeNumber(b.northEast.lngX,0);b.northEast.latY=Mapabc.Util.encodeNumber(b.northEast.latY,0)}c.bounds=b;b={};b.id=c.id;b.vector=a;b.overlay=c;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.overlay.center.lngX)||!isNaN(b.overlay.center.latY)){b.overlay.center.lngX=
Mapabc.Util.encodeNumber(b.overlay.center.lngX,0);b.overlay.center.latY=Mapabc.Util.encodeNumber(b.overlay.center.latY,0)}this.circeList.push(b)};g.prototype.LineToMPolyline=function(a){var c=ga.createSymbolizer(a,a.renderIntent),b=new ea;b.alpha=c.strokeOpacity;b.color=c.strokeColor;b.thickness=c.strokeWidth;c=new ca;c.lineStyle=b;c=new I(Fa(a.geometry.components),c);c.id=a.id;b={};b.id=c.id;b.vector=a;b.overlay=c;if(this.returnCoordType==COORD_TYPE_ENCODE)for(a=0;a<b.overlay.lnglatArr.length;a++)if(!isNaN(b.overlay.lnglatArr[a].lngX)||
!isNaN(b.overlay.lnglatArr[a].latY)){b.overlay.lnglatArr[a].lngX=Mapabc.Util.encodeNumber(b.overlay.lnglatArr[a].lngX,0);b.overlay.lnglatArr[a].latY=Mapabc.Util.encodeNumber(b.overlay.lnglatArr[a].latY,0)}this.lineList.push(b)};ma.prototype.layerType=null;ma.prototype.option=null;g.prototype.fromContainerPixelToLngLat=function(a){a=p(this.map.getLonLatFromPixel(a));if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.lngX)||!isNaN(a.latY)){a.lngX=Mapabc.Util.encodeNumber(a.lngX,0);a.latY=Mapabc.Util.encodeNumber(a.latY,
0)}return a};g.prototype.fromLngLatToContainerPixel=function(a){return this.map.getPixelFromLonLat(k(a))};g.prototype.traffic=null;g.prototype.satellite=null;g.prototype.custommaplayerlist=[];g.prototype.tilelayerlist=[];g.prototype.addTileLayer=function(a){var c=document.getElementById("Attribution").style.right,b=a.option;switch(a.layerType){case TL_TRAFFIC:if(this.traffic)return;this.traffic=new Mapabc.Layer.TMS(TL_TRAFFIC,Mapabc_traffic_layer_url,{getURL:va,displayOutsideMaxExtent:false,isBaseLayer:false,
buffer:0,alpha:false,maxExtent:new Mapabc.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7)});this.map.isTraffic=true;this.map.addLayer(this.traffic);this.map.traffic=this.traffic;this.map.isTraffic=false;break;case TL_USERMAP:if(b){a=MSISGetKey("ame.js");a=Mapabc_usermap_layer_url+"config=MAPRENDER&a_k="+a;if(b.userId)a+="&userId="+b.userId;if(b.tempId)a+="&tempId="+b.tempId;b=new Mapabc.Layer.TMS(TL_USERMAP,a,{getURL:Ha,displayOutsideMaxExtent:false,isBaseLayer:false,buffer:0,alpha:true,
opt:b,maxExtent:new Mapabc.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7)});this.map.isUsermap=true;this.map.addLayer(b);this.map.usermap=b;this.map.isUsermap=false;a={};a.id=b.id;a.layer=b;this.tilelayerlist.push(a)}break;case TL_MASS_TRANSIT:if(this.satellite)return;this.satellite=new Mapabc.Layer.TMS(TL_MASS_TRANSIT,Mapabc_masstransit_layer_url,{getURL:va,displayOutsideMaxExtent:false,isBaseLayer:false,buffer:0,alpha:true,maxExtent:new Mapabc.Bounds(-2.003750834E7,-2.003750834E7,
2.003750834E7,2.003750834E7)});this.map.isSatellite=true;this.map.addLayer(this.satellite);this.map.satellite=this.satellite;this.map.isSatellite=false;break;case TL_REAL_ESTATE:break;case TL_CUSTOM_MAP:if(a=b.tileUrl){b=new Mapabc.Layer.TMS(TL_CUSTOM_MAP,a,{getURL:Ia,displayOutsideMaxExtent:false,isBaseLayer:false,buffer:0,alpha:true,opt:b,maxExtent:new Mapabc.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7)});this.map.isCustommap=true;this.map.addLayer(b);this.map.custommap=b;this.map.isCustommap=
false;a={};a.id=b.id;a.layer=b;this.custommaplayerlist.push(a)}break}if(b=Mapabc.Util.getElement("Attribution"))b.style.right=c};g.prototype.removeTileLayer=function(a,c){var b=document.getElementById("Attribution").style.right;if(TL_TRAFFIC==a&&this.traffic){this.map.removeLayer(this.traffic);this.traffic=null}else if(TL_MASS_TRANSIT==a&&this.satellite){this.map.removeLayer(this.satellite);this.satellite=null}else if(TL_USERMAP==a)if(c instanceof Array)for(var d=0,e=this.tilelayerlist.length;d<e;d++)for(var f=
0,n=c.length;f<n;f++)if(c[f]){if(this.tilelayerlist[d])if(c[f]==this.tilelayerlist[d].id){this.map.removeLayer(this.tilelayerlist[d].layer);this.tilelayerlist.splice(d,1)}}else{this.map.removeLayer(this.tilelayerlist[d].layer);this.tilelayerlist.splice(d,1)}else{d=0;for(e=this.tilelayerlist.length;d<e;d++)if(c){if(c==this.tilelayerlist[d].id){this.map.removeLayer(this.tilelayerlist[d].layer);this.tilelayerlist.splice(d,1)}}else{this.map.removeLayer(this.tilelayerlist[d].layer);this.tilelayerlist.splice(d,
1)}}else if(TL_CUSTOM_MAP==a)if(c instanceof Array){if(this.custommaplayerlist){d=0;for(e=this.custommaplayerlist.length;d<e;d++){f=0;for(n=c.length;f<n;f++)if(c[f]){if(this.custommaplayerlist[d])if(c[f]==this.custommaplayerlist[d].id){this.map.removeLayer(this.custommaplayerlist[d].layer);this.custommaplayerlist.splice(d,1)}}else{this.map.removeLayer(this.custommaplayerlist[d].layer);this.custommaplayerlist.splice(d,1)}}}}else{if(this.custommaplayerlist){d=0;for(e=this.custommaplayerlist.length;d<
e;d++)if(c){if(c==this.custommaplayerlist[d].id){this.map.removeLayer(this.custommaplayerlist[d].layer);this.custommaplayerlist.splice(d,1)}}else{this.map.removeLayer(this.custommaplayerlist[d].layer);this.custommaplayerlist.splice(d,1)}}}else if(a=="ALL"){this.traffic&&this.map.removeLayer(this.traffic);this.satellite&&this.map.removeLayer(this.satellite);d=0;for(e=this.tilelayerlist.length;d<e;d++){this.map.removeLayer(this.tilelayerlist[d].layer);this.tilelayerlist.splice(d,1)}if(this.custommaplayerlist){f=
0;for(e=this.custommaplayerlist.length;f<e;f++){this.map.removeLayer(this.custommaplayerlist[f].layer);this.custommaplayerlist.splice(f,1)}}this.satellite=this.traffic=null}if(d=Mapabc.Util.getElement("Attribution"))d.style.right=b};g.prototype.getOverlaysByType=function(a){switch(a){case i.TYPE_MARKER:return A(this.markerList,"overlay");case i.TYPE_MBOX:return A(this.boxList,"overlay");case i.TYPE_GROUNDIMAGE:return A(this.groundImagesList,"overlay");case i.TYPE_LABEL:return A(this.labelList,"overlay");
case i.TYPE_POLYLINE:return A(this.lineList,"overlay");case i.TYPE_POLYGON:return A(this.polygonList,"overlay");case i.TYPE_CIRCLE:return A(this.circeList,"overlay");case i.TYPE_RECTANGLE:return A(this.rectList,"overlay");case i.TYPE_AREA:a=[];a.push(A(this.rectList,"overlay"));a.push(A(this.polygonList,"overlay"));a.push(A(this.circeList,"overlay"));return a}return null};g.prototype.getCenter=function(){var a=this.map.getCenter();a=p(a);if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.lngX)||
!isNaN(a.latY)){a.lngX=Mapabc.Util.encodeNumber(a.lngX,0);a.latY=Mapabc.Util.encodeNumber(a.latY,0)}return a};g.prototype.getZoomLevel=function(){return this.map.getZoom()};g.prototype.getSize=function(){mapSize=this.map.getSize();return new Q(mapSize.w,mapSize.h)};g.prototype.getLngLatBounds=function(){var a=this.map.getExtent();a=new R(p(new Mapabc.LonLat(a.left,a.bottom)),p(new Mapabc.LonLat(a.right,a.top)));if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.southWest.lngX)||!isNaN(a.northEast.lngX)||
!isNaN(a.southWest.lngY)||!isNaN(a.northEast.latY)){a.southWest.lngX=Mapabc.Util.encodeNumber(a.southWest.lngX,0);a.southWest.latY=Mapabc.Util.encodeNumber(a.southWest.latY,0);a.northEast.lngX=Mapabc.Util.encodeNumber(a.northEast.lngX,0);a.northEast.latY=Mapabc.Util.encodeNumber(a.northEast.latY,0)}return a};g.prototype.setMapUrl=function(a,c,b){if(!(c==null||c==""))if(!(a==""||a==null)){var d=null;if(c==IMAGE_64)d=new Mapabc.Size(64,64);else if(c==IMAGE_128)d=new Mapabc.Size(128,128);else if(c==
IMAGE_256)d=new Mapabc.Size(256,256);else return;if(b<this.map.minZoomLevel&&b&&b==""&&b>this.map.maxZoomLevel)b=this.getZoomLevel();this.map.zoom=b;this.map.removeLayer(this.mapnik);this.mapnik=new Mapabc.Layer.TMS("\u00a9 AutoNavi \u00a9 MapABC.com",a,{getURL:ta,buffer:0,displayOutsideMaxExtent:true,attribution:this.map.logoUrl});this.mapnik.setTileSize(d);this.map.addLayer(this.mapnik);b&&this.setZoomLevel(b)}};g.prototype.setDefaultMarkerOption=function(a){if(a instanceof ba)this.markerOptions=
a};g.prototype.setDefaultAreaOption=function(a){if(a instanceof S)this.areaOptions=a};g.prototype.setDefaultLineOption=function(a){if(a instanceof ca)this.lineOptios=a};g.prototype.setOverviewState=function(a){if(this.map.getControl("overviewMap")!=null)if(a==OPEN_OVERVIEW){this.map.getControl("overviewMap").div.style.display="";this.map.getControl("overviewMap").maximizeControl()}else if(a==CLOSE_OVERVIEW){this.map.getControl("overviewMap").div.style.display="";this.map.getControl("overviewMap").minimizeControl()}else if(a==
HIDE_OVERVIEW){this.map.getControl("overviewMap").div.style.display="none";document.getElementById("Attribution").style.right="15px"}};g.prototype.getOverlayVisibleById=function(a){if(a=Mapabc.Util.getElement(a))if(a.style.display==""||a.style.display=="inline-block")return true;else if(a.style.display=="none")return false};g.prototype.setOverlayVisibleById=function(a,c){if(a instanceof Array){for(var b=a.length,d=[],e=0;e<b;e++)d.push(this.setOverlayVisibleById(a[e],c));return d}else{e=this.getOverlayById(a);
b=Mapabc.Util.getElement(a);if(e instanceof w)if(b){for(e=0;e<this.markerList.length;e++){obj=this.markerList[e];if(obj.id==a){b=obj.vector;if(c){if(b.label&&b.label.div)b.label.div.style.display="";b.markerImg.style.display="";this.setOverlayEditableById(a,true)}else{if(b.label&&b.label.div)b.label.div.style.display="none";b.markerImg.style.display="none";this.setOverlayEditableById(a,false);this.closeTip(a)}}}return 0}else return-1;else if(e instanceof E||e instanceof U||e instanceof O)if(b){if(c){b.style.display=
"";this.setOverlayEditableById(a,true)}else{b.style.display="none";this.setOverlayEditableById(a,false);this.closeTip(a)}return 0}else return-1;else if(e instanceof K||e instanceof I||e instanceof J||e instanceof G)if(e=this.getOverlayById(a,"vector")){if(c){e.style.display="";this.setOverlayEditableById(a,true)}else{e.style.display="none";this.setOverlayEditableById(a,false);this.closeTip(a)}l.drawn=false;l.moveTo();return 0}else return-1;else return-1}};g.prototype.loadCtrlPanel=function(a,c){var b=
null;if(a==OVERVIEW_CTRL){(b=this.map.getControl("overviewMap"))&&this.map.removeControl(b);if(c)c.overviewMap==DEFAULT&&this.map.addControl(new Mapabc.Control.OverviewMap({id:"overviewMap"}));else this.map.addControl(new Mapabc.Control.OverviewMap({id:"overviewMap"}))}else if(a==SCALE_CTRL)if(b=this.map.getControl("scaleline"))this.map.getControl("scaleline").div.style.display="";else this.map.addControl(new Mapabc.Control.ScaleLine({id:"scaleline"}));else if(a==TOOLBAR_CTRL){(b=this.map.getControl("panZoom"))&&
this.map.removeControl(b);b=new Mapabc.Pixel(1,1);if(c){if(c.toolbarPos&&c.toolbarPos instanceof H)b=new Mapabc.Pixel(c.toolbarPos.x,c.toolbarPos.y);if(c.toolbar==DEFAULT)this.map.addControl(new Mapabc.Control.PanZoomBar({id:"panZoom",position:b}));else if(c.toolbar==SMALL)this.map.addControl(new Mapabc.Control.PanZoom({id:"panZoom",position:b}));else c.toolbar==MINI&&this.map.addControl(new Mapabc.Control.PanZoom({id:"panZoom",isMINI:true,position:b}))}else this.map.addControl(new Mapabc.Control.PanZoomBar({id:"panZoom",
position:b}))}};g.prototype.panDirection=function(a,c){var b=0,d=0;b=a==1?this.getSize().width/2:-this.getSize().width/2;if(c==1)d=this.getSize().height/2;else if(c==-1)d=-this.getSize().height/2;this.panBy(new Q(b,d),null,SLIDING_EXPO)};g.prototype.getScale=function(){var a=this.map.getLayerPxFromLonLat(this.map.getCenter()),c=new H(a.x+1,a.y);a=this.map.getLonLatFromPixel(a);c=this.map.getLonLatFromPixel(c);c=(new Mapabc.Geometry.LineString([new Mapabc.Geometry.Point(a.lon,a.lat),new Mapabc.Geometry.Point(c.lon,
c.lat)])).getGeodesicLength(this.map.getProjectionObject());return Math.round(c)};g.prototype.setCenter=function(a){this.map.setCenter(k(a))};g.prototype.setZoomLevel=function(a){this.map.zoomTo(parseInt(a))};g.prototype.setZoomAndCenter=function(a,c){this.map.setCenter(k(c),parseInt(a))};g.prototype.zoomIn=function(a){var c=this.map.getZoom()+1;this.map.isValidZoomLevel(c)&&this.zoomChange(c,"in",a)};g.prototype.zoomOut=function(a){var c=this.map.getZoom()-1;if(c<3)c=3;this.zoomChange(c,"out",a)};
g.prototype.zoomChange=function(a,c,b){var d=false;if(b instanceof z){var e=this.getLngLatBounds();if(e.southWest.lngX<b.lngX&&e.southWest.latY<b.latY&&e.northEast.lngX>b.lngX&&e.northEast.latY>b.latY)d=true;if(d){c=k(b);d=this.map.getPixelFromLonLat(c);e=this.map.getSize();b=e.w/2-d.x;d=d.y-e.h/2;e=this.map.baseLayer.getResolutionForZoom(a);this.map.setCenter(new Mapabc.LonLat(c.lon+b*e,c.lat+d*e),a)}else{this.setCenter(b);if(c=="in")this.map.zoomIn();else c=="out"&&this.map.zoomOut()}}else this.map.setCenter(null,
a)};g.prototype.panTo=function(a){this.map.panTo(k(a))};g.prototype.panBy=function(a,c,b){if(!b||b=="undefined")b=SLIDING_LINEAR;this.map.pan(a.width,a.height,null,c,b)};g.prototype.getPixelBounds=function(){var a=this.map.calculateBounds();return new M(this.map.getLayerPxFromLonLat(new Mapabc.LonLat(a.left,a.top)),this.map.getLayerPxFromLonLat(new Mapabc.LonLat(a.right,a.bottom)))};g.prototype.setLngLatBounds=function(a,c,b,d){if(a instanceof R)try{var e=k(a.southWest),f=k(a.northEast),n=new Mapabc.Bounds(e.lon,
e.lat,f.lon,f.lat);this.map.zoomToExtent(n,true,-1)}catch(h){}else if(a!=null&&a!=undefined&&c!=null&&c!=undefined&&b!=null&&b!=undefined&&d!=null&&d!=undefined)try{e=k(new z(a,c));f=k(new z(b,d));n=new Mapabc.Bounds(e.lon,e.lat,f.lon,f.lat);this.map.zoomToExtent(n,true,-1)}catch(o){}};g.prototype.setZoomEnabled=function(a){if(a==true){this.map.zoomEnabled=a;this.navigation.handlers.wheel.activate();this.zoomBox&&this.magnifyingglassForMap()}else if(a==false){this.map.zoomEnabled=a;this.navigation.handlers.wheel.deactivate();
if(this.zoomBox)(a=Mapabc.Util.getElement("map_magnifyingglass"))&&a.parentNode.removeChild(a)}};g.prototype.getZoomEnabled=function(){return this.map.zoomEnabled};g.prototype.setDragEnabled=function(a){this.map.setDragEnabled(a)};g.prototype.getDragEnabled=function(){return this.map.dragEnabled};g.prototype.setContinuousZoom=function(a){if(a)this.map.isContinuous=a;else if(a==false)this.map.isContinuous=a};g.prototype.getContinuousZoom=function(){return this.map.isContinuous};g.prototype.setZoomWheelEnabled=
function(a){this.map.setZoomWheelEnabled(a)};g.prototype.setFitview=function(a){if(a){for(var c=null,b=null,d=0,e=a.length;d<e;d++)if(a[d]){var f=a[d]instanceof Object?this.getOverlayById(a[d].id):this.getOverlayById(a[d]);if(f){if(f instanceof w){if(isNaN(f.lnglat.lngX)||isNaN(f.lnglat.latY))f.lnglat=Mapabc.Util.getCoord(f.lnglat);f=k(f.lnglat);b=new Mapabc.Bounds(f.lon,f.lat,f.lon,f.lat)}else if(f instanceof I){for(b=0;b<f.lnglatArr.length;b++)if(isNaN(f.lnglatArr[b].lngX)||isNaN(f.lnglatArr[b].latY))f.lnglatArr[b]=
Mapabc.Util.getCoord(f.lnglatArr[b]);f=ra(f);b=f.geometry.getBounds()}else if(f instanceof K){for(b=0;b<f.lnglatArr.length;b++)if(isNaN(f.lnglatArr[b].lngX)||isNaN(f.lnglatArr[b].latY))f.lnglatArr[b]=Mapabc.Util.getCoord(f.lnglatArr[b]);f=qa(f);b=f.geometry.getBounds()}else if(f instanceof J){for(b=0;b<f.lnglatArr.length;b++)if(isNaN(f.lnglatArr[b].lngX)||isNaN(f.lnglatArr[b].latY))f.lnglatArr[b]=Mapabc.Util.getCoord(f.lnglatArr[b]);f=pa(f);b=f.geometry.getBounds()}else if(f instanceof G){if(isNaN(f.center.lngX)||
isNaN(f.center.latY))f.center=Mapabc.Util.getCoord(f.center);f=oa(f);b=f.geometry.getBounds()}else if(f instanceof O){if(isNaN(f.lnglat.lngX)||isNaN(f.lnglat.latY))f.lnglat=Mapabc.Util.getCoord(f.lnglat);this.addLabel(f);f=k(f.lnglat);b=new Mapabc.Bounds(f.lon,f.lat,f.lon,f.lat)}else if(f instanceof E){if(isNaN(f.lnglat.lngX)||isNaN(f.lnglat.latY))f.lnglat=Mapabc.Util.getCoord(f.lnglat);f=k(f.lnglat);b=new Mapabc.Bounds(f.lon,f.lat,f.lon,f.lat)}if(c==null)c=b;else c.extend(b)}}!isNaN(c.left)&&!isNaN(c.top)&&
!isNaN(c.bottom)&&!isNaN(c.right)&&this.map.zoomToExtent(c,false,0)}};g.prototype.savePosition=function(){this.zoom=this.getZoomLevel();this.center=this.getCenter()};g.prototype.returnToSavedPosition=function(){if(isNaN(this.center.lngX)||isNaN(this.center.latY))this.center=Mapabc.Util.getCoord(this.center);this.map.setCenter(k(this.center),this.zoom)};g.prototype.markerMoveTo=function(a,c){var b=this.getOverlayById(a,"vector"),d=k(c);if(b){this.closeTip();if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(c.lngX)||
!isNaN(c.latY)){c.lngX=Mapabc.Util.encodeNumber(c.lngX,0);c.latY=Mapabc.Util.encodeNumber(c.latY,0)}if(b.label)b.label.lonlat=d;b.lonlat=d;this.getOverlayById(a).lnglat=c;d=this.map.getLayerPxFromLonLat(d);if(b.overlay){var e=Mapabc.Util.getOffXY(b.overlay.option.imageAlign,b.icon.size);d.x-=e.x;d.y-=e.y}b.label&&b.label.moveTo(d);b.icon.moveTo(d)}};g.prototype.setCtrlPanelState=function(a,c){if(a==TOOLBAR_CTRL){if(this.map.getControl("panZoom")!=null)if(c==HIDE)this.map.getControl("panZoom").div.style.display=
"none";else if(c==SHOW)this.map.getControl("panZoom").div.style.display=""}else if(a==SCALE_CTRL){if(this.map.getControl("scaleline")!=null)if(c==HIDE)this.map.getControl("scaleline").div.style.display="none";else if(c==SHOW)this.map.getControl("scaleline").div.style.display=""}else if(a==OVERVIEW_CTRL)if(this.map.getControl("overviewMap")!=null)if(c==HIDE){this.map.getControl("overviewMap").div.style.display="none";document.getElementById("Attribution").style.right="15px"}else if(c==SHOW){this.map.getControl("overviewMap").div.style.display=
"";this.map.getControl("overviewMap").maximizeControl()}else if(c==MINIMIZE){this.map.getControl("overviewMap").div.style.display="";this.map.getControl("overviewMap").minimizeControl()}};g.prototype.getCtrlPanelState=function(a){if(a==OVERVIEW_CTRL){if(this.map.getControl("overviewMap")==null)return null;if(this.map.getControl("overviewMap").div.style.display=="none")return null;if(this.map.getControl("overviewMap").div.firstChild.style.display=="none")return"mini";if(this.map.getControl("overviewMap").div.firstChild.style.display==
"")return"show"}};wa.prototype.lnglatArr=null;z.prototype.lngX=null;z.prototype.latY=null;z.prototype.TYPE=COORD_TYPE_OFFSET;H.prototype.x=0;H.prototype.y=0;Q.prototype.height=null;Q.prototype.width=null;R.prototype.southWest=null;R.prototype.northEast=null;R.prototype.getSouthWest=function(){return this.southWest};R.prototype.getNorthEast=function(){return this.northEast};i.TYPE_MARKER="Marker";i.TYPE_LABEL="Label";i.TYPE_POLYLINE="Polyline";i.TYPE_POLYGON="Polygon";i.TYPE_CIRCLE="Circle";i.TYPE_RECTANGLE=
"Rectangle";i.TYPE_AREA="Area";i.TYPE_GROUNDIMAGE="GroundImage";i.TYPE_MBOX="Box";i.TYPE_ALL="All";i.instanceCount=0;i.prototype.TYPE=null;i.prototype.id=null;i.prototype.bounds=null;Y.prototype=new i;Y.prototype.lnglatArr=null;Y.prototype.option=new S;J.prototype=new Y;J.prototype.lnglatArr=null;I.prototype=new i;I.prototype.lnglatArr=null;I.prototype.option=null;K.prototype=new Y;K.prototype.lnglatArr=null;E.prototype=new i;E.prototype.lnglat=null;E.prototype.option=null;w.prototype=new i;w.prototype.lnglat=
null;w.prototype.option=null;w.prototype.size=null;G.prototype=new Y;G.prototype.radius=10;G.prototype.center=null;M.prototype.maxX=null;M.prototype.maxY=null;M.prototype.minX=null;M.prototype.minY=null;M.prototype.topLeftPt=null;M.prototype.rightBottomPt=null;M.prototype.getCenter=function(){if(this.maxX==null||this.minX==null||this.maxY==null||this.minY==null)return null;return new H((this.maxX-this.minX)/2,(this.maxY-this.minY)/2)};M.prototype.getTopLeft=function(){return this.topLeftPt};M.prototype.getRightBottom=
function(){return this.rightBottomPt};M.prototype.containsBounds=function(a){return a.maxX<=this.maxX&&a.maxY<=this.maxY&&a.minX>=this.minX&&a.minY>=this.minY?true:false};M.prototype.contains=function(a){return a.x<=this.maxX&&a.y<=this.maxY&&a.x>=this.minX&&a.y>=this.minY?true:false};g.prototype.removeOverlays=function(a){if(a){var c=a.length;if(c!=0)for(var b=0;b<c;b++)a[b]&&this.removeOverlayById(a[b].id)}};g.prototype.removeAllOverlays=function(){this.setCurrentMouseTool(PAN_WHEELZOOM);s&&this.map.removePopup(s);
this.drawfeatureCtrl&&this.drawfeatureCtrl.deactivate();s=null;var a=0;if(this.markerList.length!=0){for(var c=0,b=j.length;c<b;c++)if(j[c]){this.removeEventListener(j[c].obj,j[c].type,j[c].func);c-=1}a++}if(this.boxList.length!=0){c=0;for(b=j.length;c<b;c++)if(j[c]){this.removeEventListener(j[c].obj,j[c].type,j[c].func);c-=1}a++}this.groundImagesList.length!=0&&a++;this.rectList.length!=0&&a++;this.polygonList.length!=0&&a++;this.circeList.length!=0&&a++;this.labelList.length!=0&&a++;this.lineList.length!=
0&&a++;T.length!=0&&a++;N.length!=0&&a++;l.removeFeatures(l.features);C.clearMarkers({whetherAll:false});C.clearLabels();P.clearMarkers({whetherAll:false});this.markerList=[];this.boxList=[];this.groundImagesList=[];this.rectList=[];this.polygonList=[];this.circeList=[];this.labelList=[];this.lineList=[];T=[];N=[];this.drawfeatureCtrl&&this.drawfeatureCtrl.activate();if(a!=0){a={};a.type="featuresremoved";L(a)}};g.prototype.removeOverlay=function(a){this.removeOverlayById(a.id)};g.prototype.removeOverlaysByType=
function(a){if(a==i.TYPE_MARKER){for(var c=0,b=j.length;c<b;c++)if(j[c]){this.removeEventListener(j[c].obj,j[c].type,j[c].func);c-=1}C.clearMarkers({whetherAll:true},a);this.markerList=[];this.closeTip("_MARKER_")}else if(a==i.TYPE_GROUNDIMAGE){C.clearMarkers({whetherAll:true},a);this.groundImagesList=[]}else if(a==i.TYPE_MBOX){c=0;for(b=j.length;c<b;c++)if(j[c]){this.removeEventListener(j[c].obj,j[c].type,j[c].func);c-=1}a=0;for(b=this.boxList.length;a<b;a++){c={};c.type="featureremoved";c.feature=
this.boxList[a].vector;L(c)}P.clearMarkers();this.boxList=[]}else if(a==i.TYPE_LABEL){C.clearLabels("only");this.labelList=[]}else if(a==i.TYPE_POLYLINE){l.removeFeatures(A(this.lineList,"feature","_POLYLINE_"),{whetherAll:true});this.lineList=[];l.removeFeatures(A(T,"feature"),{whetherAll:true});a=0;for(b=T.length;a<b;a++)l.removeFeatures(T[a].label,{whetherAll:true});T=[];this.closeTip("_POLYLINE_")}else if(a==i.TYPE_POLYGON){l.removeFeatures(A(this.polygonList,"feature"),{whetherAll:true});this.polygonList=
[];l.removeFeatures(A(N,"feature","_POLYGON_"),{whetherAll:true});a=0;for(b=N.length;a<b;a++)l.removeFeatures(N[a].label,{whetherAll:true});N=[];this.closeTip("_POLYGON_")}else if(a==i.TYPE_CIRCLE){l.removeFeatures(A(this.circeList,"feature","_Circle_"),{whetherAll:true});this.circeList=[];this.closeTip("_Circle_")}else if(a==i.TYPE_RECTANGLE){l.removeFeatures(A(this.rectList,"feature","_RECTANGLE_"),{whetherAll:true});this.rectList=[];this.closeTip("_RECTANGLE_")}else if(a==i.TYPE_AREA){l.removeFeatures(A(this.rectList,
"feature","_RECTANGLE_"),{whetherAll:true});this.rectList=[];this.closeTip("_RECTANGLE_");l.removeFeatures(A(this.circeList,"feature"),{whetherAll:true});this.circeList=[];l.removeFeatures(A(this.polygonList,"feature","_POLYGON_"),{whetherAll:true});this.polygonList=[];this.closeTip("_POLYGON_");l.removeFeatures(A(N,"feature"),{whetherAll:true});a=0;for(b=N.length;a<b;a++)l.removeFeatures(N[a].label,{whetherAll:true});N=[]}else a==i.TYPE_ALL&&this.removeAllOverlays()};g.prototype.removeOverlayById=
function(a,c){for(var b=0,d=null,e=this.getOverlayById(a);b<this.markerList.length;b++){d=this.markerList[b];if(d.id==a){e=0;for(var f=j.length;e<f;e++)if(j[e])if(j[e].id==a){this.removeEventListener(j[e].obj,j[e].type,j[e].func);e-=1}C.removeMarker(d.vector,{whetherAll:true});this.markerList.splice(b,1);this.closeTip(d.id);return}}for(b=0;b<this.boxList.length;b++){d=this.boxList[b];if(d.id==a){e=0;for(f=j.length;e<f;e++)if(j[e])if(j[e].id==a){this.removeEventListener(j[e].obj,j[e].type,j[e].func);
e-=1}P.removeMarker(d.vector,{whetherAll:true});this.boxList.splice(b,1);b={};b.type="featureremoved";b.feature=d.vector;L(b);return}}for(b=0;b<this.groundImagesList.length;b++){d=this.groundImagesList[b];if(d.id==a){e=0;for(f=j.length;e<f;e++)if(j[e])if(j[e].id==a){this.removeEventListener(j[e].obj,j[e].type,j[e].func);e-=1}if(c!=true&&c!=false)c=true;C.removeGroundImage(d.vector,{whetherAll:c});this.groundImagesList.splice(b,1);this.closeTip(d.id);return}}for(b=0;b<this.lineList.length;b++){d=this.lineList[b];
if(e)d.vector.update=e.update;if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});this.lineList.splice(b,1);this.closeTip(d.id);this.unSelectFeature(d.vector,"_POLYLINE_");return}}for(b=0;b<this.labelList.length;b++){d=this.labelList[b];if(e)d.vector.update=e.update;if(d.id==a){C.removeLabel(d.vector,{whetherAll:true});this.labelList.splice(b,1);return}}for(b=0;b<this.rectList.length;b++){d=this.rectList[b];if(e)d.vector.update=e.update;if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});
this.rectList.splice(b,1);this.closeTip(d.id);this.unSelectFeature(d.vector,"_RECTANGLE_");return}}for(b=0;b<this.polygonList.length;b++){d=this.polygonList[b];if(e)d.vector.update=e.update;if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});this.polygonList.splice(b,1);this.closeTip(d.id);this.unSelectFeature(d.vector,"_POLYGON_");return}}for(b=0;b<this.circeList.length;b++){d=this.circeList[b];if(e)d.vector.update=e.update;if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});this.closeTip(d.id);
this.circeList.splice(b,1);return}}for(b=0;b<T.length;b++){d=T[b];if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});l.removeFeatures(d.label);this.circeList.splice(b,1);return}}for(b=0;b<N.length;b++){d=N[b];if(d.id==a){l.removeFeatures(d.vector,{whetherAll:true});l.removeFeatures(d.label);this.circeList.splice(b,1);return}}};g.prototype.updateOverlay=function(a){a.id=String(a.id);if(a instanceof w){if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);this.updateMarker(a)}else if(a instanceof
E){if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);this.updateBox(a)}else if(a instanceof U){if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);this.updateGroundImage(a)}else if(a instanceof O){if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);this.updateLabel(a)}else{if(a instanceof G){if(isNaN(a.center.lngX)||isNaN(a.center.latY))a.center=Mapabc.Util.getCoord(a.center)}else for(var c=0;c<
a.lnglatArr.length;c++)if(isNaN(a.lnglatArr[c].lngX)||isNaN(a.lnglatArr[c].latY))a.lnglatArr[c]=Mapabc.Util.getCoord(a.lnglatArr[c]);this.modifyctrl.unselectFeature(a);a.update=true;this.addOverlay(a)}this.addEventListener(a,"mouseup",this.map._MMAPABC_EVENT_MOUSEUP_);this.closeTip()};g.prototype.updateMarker=function(a){for(var c=this.markerList.length,b=null,d=0;d<c;d++)if(a.id==this.markerList[d].vector.id)b=this.markerList[d].vector;if(b&&b.overlay){var e=a.option.anchor;if(a.option.anchor)e=
new Mapabc.Pixel(e.x,e.y);if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);d=k(a.lnglat);c=this.map.getLayerPxFromLonLat(d);b.lonlat=d;if(b.label)b.label.lonlat=d;b.zIndex=a.option.zIndex_option;b.offset=e;b.update=true;if(e=Mapabc.Util.getElement(b.markerImg.id))e.style.zIndex=b.zIndex;if(b.label&&b.label.div){b.label.div.innerHTML=a.option.labelOption.content;b.label.div.style.color=Mapabc.Util.MChangeColor(a.option.labelOption.fontStyle.color);b.label.div.style.fontFamily=
a.option.labelOption.fontStyle.name;b.label.labelAlign=a.option.labelOption.labelAlign;b.label.labelPosition=a.option.labelOption.labelPosition;if(Mapabc.Util.getBrowserName()=="msie")b.label.div.style.filter="alpha(opacity="+a.option.labelOption.alpha*100+")";else if(Mapabc.Util.getBrowserName()=="firefox")b.label.div.style.opacity=a.option.labelOption.alpha;if(a.option.labelOption.hasBorder)b.label.div.style.borderColor=Mapabc.Util.MChangeColor(a.option.labelOption.borderColor);else if(Mapabc.Util.getBrowserName()==
"msie"){b.label.div.style.borderBottom="";b.label.div.style.borderLeft="";b.label.div.style.borderTop="";b.label.div.style.borderRight=""}else if(Mapabc.Util.getBrowserName()=="firefox")b.label.div.style.border="0px";b.label.div.style.backgroundColor=a.option.labelOption.hasBackground?Mapabc.Util.MChangeColor(a.option.labelOption.backgroundColor):"";b.label.div.style.fontWeight=a.option.labelOption.fontStyle.bold?"bold":"";if(Number(b.label.div.style.fontSize.replace("px",""))!=a.option.labelOption.fontStyle.size)b.label.div.style.fontSize=
a.option.labelOption.fontStyle.size+"px"}else if(a.option.labelOption){e={content:a.option.labelOption.content,fontColor:x(a.option.labelOption.fontStyle.color),fontSize:a.option.labelOption.fontStyle.size,fontFamily:a.option.labelOption.fontStyle.name,fontWeight:a.option.labelOption.fontStyle.bold,alpha:a.option.labelOption.alpha,hasBackground:a.option.labelOption.hasBackground,hasBorder:a.option.labelOption.hasBorder,backgroundColor:x(a.option.labelOption.backgroundColor),borderColor:x(a.option.labelOption.borderColor),
labelAlign:a.option.labelOption.labelAlign,labelPosition:a.option.labelOption.labelPosition};b.label=new Mapabc.Label(d,e);C.addLabel(b.label)}if(a.option.canShowTip){b.events.unregister("click",b,ka);b.events.register("click",b,ka)}else b.events.unregister("click",b,ka);if(a.option.imageSize){d=new Mapabc.Size(a.option.imageSize.width,a.option.imageSize.height);b.icon.setSize(d)}a.option.isEditable?this.setOverlayEditableById(a.id,true):this.setOverlayEditableById(a.id,false);b.icon.setUrl(a.option.imageUrl);
b.label&&b.label.moveTo(c);if(b.offset)if(b.offset.x!=0||b.offset.y!=0)b.overlay.option.imageAlign=8;d=Mapabc.Util.getOffXY(b.overlay.option.imageAlign,b.icon.size);c.x-=d.x;c.y-=d.y;b.icon.moveTo(c,true);a.option.rotation&&b.rotate(a.option.rotation)}};g.prototype.updateBox=function(a){for(var c=this.boxList.length,b=null,d=0;d<c;d++)if(a.id==this.boxList[d].vector.id)b=this.boxList[d].vector;if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);d=k(a.lnglat);c=this.map.getLayerPxFromLonLat(d);
b.zIndex=a.option.zIndex_option;b.lonlat=d;b.boxAlign=a.option.boxAlign;if(a._jstype_!="drag")a.option.isEditable?this.setOverlayEditableById(a.id,true):this.setOverlayEditableById(a.id,false);if(b=Mapabc.Util.getElement(a.id)){P.box.content=a.option.content;b.innerHTML=a.option.content;b.style.zIndex=a.option.zIndex_option;a=Mapabc.Util.getOffXY(a.option.boxAlign,new Mapabc.Size(b.offsetWidth,b.offsetHeight));c.x-=a.x;c.y-=a.y;b.style.left=c.x+"px";b.style.top=c.y+"px"}};g.prototype.updateGroundImage=
function(a){this.removeOverlayById(a.id,false);a.isTriggerEvent=false;this.addOverlay(a)};g.prototype.updateLabel=function(a){a.update=true;this.addOverlay(a)};g.prototype.getOverlayById=function(a,c){var b,d;for(d=0;d<this.markerList.length;d++){b=this.markerList[d];if(b.id==a)if(c==undefined||c=="overlay"){if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.overlay.lnglat.lngX)||!isNaN(b.overlay.lnglat.latY)){b.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(b.overlay.lnglat.lngX,0);b.overlay.lnglat.latY=
Mapabc.Util.encodeNumber(b.overlay.lnglat.latY,0)}return b.overlay}else if(c=="vector")return b.vector}for(d=0;d<this.boxList.length;d++){b=this.boxList[d];if(b.id==a)if(c==undefined||c=="overlay"){if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.overlay.lnglat.lngX)||!isNaN(b.overlay.lnglat.latY)){b.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(b.overlay.lnglat.lngX,0);b.overlay.lnglat.latY=Mapabc.Util.encodeNumber(b.overlay.lnglat.latY,0)}return b.overlay}else if(c=="vector")return b.vector}for(d=
0;d<this.groundImagesList.length;d++){b=this.groundImagesList[d];if(b.id==a)if(c==undefined||c=="overlay"){if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(b.overlay.lnglat.lngX)||!isNaN(b.overlay.lnglat.latY)){b.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(b.overlay.lnglat.lngX,0);b.overlay.lnglat.latY=Mapabc.Util.encodeNumber(b.overlay.lnglat.latY,0)}return b.overlay}else if(c=="vector")return b.vector}for(d=0;d<this.lineList.length;d++){b=this.lineList[d];if(b.id==a)if(c==undefined||c=="overlay")return b.overlay;
else if(c=="vector")return b.vector}for(d=0;d<this.labelList.length;d++){b=this.labelList[d];if(b.id==a)if(c==undefined||c=="overlay")return b.overlay;else if(c=="vector")return b.vector}for(d=0;d<this.rectList.length;d++){b=this.rectList[d];if(b.id==a)if(c==undefined||c=="overlay")return b.overlay;else if(c=="vector")return b.vector}for(d=0;d<this.polygonList.length;d++){b=this.polygonList[d];if(b.id==a)if(c==undefined||c=="overlay")return b.overlay;else if(c=="vector")return b.vector}for(d=0;d<
this.circeList.length;d++){b=this.circeList[d];if(b.id==a)if(c==undefined||c=="overlay")return b.overlay;else if(c=="vector")return b.vector}return null};g.prototype.setOverlayEditableById=function(a,c){var b=this.getOverlayById(a);if(b.option.isEditable=c)if(b instanceof w||b instanceof E)this.addEventListener(b,MOUSE_DOWN,la);else{if(b instanceof I||b instanceof K||b instanceof J){this.modifyctrl.modifyfeatureArrById.push(a);this.modifyctrl.activate()}}else if(b instanceof w||b instanceof E){this.removeEventListener(b,
MOUSE_DOWN,la);this.map.events.unregister(MOUSE_MOVING,this.map,this.map._MMAPABC_EVENT_MOUSEMOVE_)}else if(b instanceof I||b instanceof K||b instanceof J){b=this.modifyctrl.modifyfeatureArrById.length;for(var d=0;d<b;d++)if(this.modifyctrl.modifyfeatureArrById[d]==a){this.modifyctrl.modifyfeatureArrById.splice(d,1);this.modifyctrl.deactivate()}}};g.prototype.setKeyboardEnabled=function(a){if(a===true)this.keyboard.activate();else a===false&&this.keyboard.deactivate()};g.prototype.getKeyboardEnabled=
function(){return this.keyboard.active};var fa=null;g.prototype.setCurrentMouseTool=function(a){var c=new Mapabc.Style;c.addRules([new Mapabc.Rule({symbolizer:{Point:{pointRadius:4,graphicName:"square",fillColor:"white",fillOpacity:1,strokeWidth:1,strokeOpacity:1,strokeColor:"#333333"},Line:{strokeWidth:3,strokeOpacity:1,strokeColor:"#666666",strokeDashstyle:"Solid"},Polygon:{strokeWidth:2,strokeOpacity:1,strokeColor:"#666666",fillColor:"white",fillOpacity:0.3}}})]);var b={strokeColor:x(this.areaOptions.areaStyle.borderStyle.color),
strokeOpacity:this.areaOptions.areaStyle.borderStyle.alpha,strokeWidth:this.areaOptions.areaStyle.borderStyle.thickness,fillColor:x(this.areaOptions.areaStyle.fillStyle.color),fillOpacity:this.areaOptions.areaStyle.fillStyle.alpha,pointRadius:6,pointerEvents:"visiblePainted"},d={strokeColor:x(this.lineOptios.lineStyle.color),strokeOpacity:this.lineOptios.lineStyle.alpha,strokeWidth:this.lineOptios.lineStyle.thickness,pointRadius:6,pointerEvents:"visiblePainted"};d.strokeDashstyle=this.lineOptios.lineStyle.lineType==
LINE_DASHED?"dash":"Solid";var e={imageUrl:this.markerOptions.imageUrl};e.imageSize=null;e.offset=null;if(this.markerOptions.imageSize)e.imageSize=new Mapabc.Size(parseInt(this.markerOptions.imageSize.width),parseInt(this.markerOptions.imageSize.height));if(this.markerOptions.anchor)e.offset=new Mapabc.Pixel(this.markerOptions.anchor.x,this.markerOptions.anchor.y);this.drawfeatureCtrl!=null&&this.drawfeatureCtrl.deactivate();if(a==ADD_MARKER){this.drawfeatureCtrl=new Mapabc.Control.DrawFeature(C,
Mapabc.Handler.Point,{type:"marker",style:e});this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==DRAW_LINE){this.drawfeatureCtrl=new Mapabc.Control.DrawFeature(l,Mapabc.Handler.Path,{style:d});this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==DRAW_CIRCLE){this.drawfeatureCtrl=new Mapabc.Control.DrawFeature(l,Mapabc.Handler.Circle,{style:b});this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);
ISSTOP_HADLEMEASUR=true}}else if(a==DRAW_POLYGON){this.navigation.deactivate();this.drawfeatureCtrl=new Mapabc.Control.DrawFeature(l,Mapabc.Handler.Polygon,{style:b});if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==DRAW_RECTANGLE){this.navigation.deactivate();this.drawfeatureCtrl=new Mapabc.Control.DrawFeature(l,Mapabc.Handler.RegularPolygon,{handlerOptions:{sides:4,irregular:true},style:b});if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==
PAN_WHEELZOOM){this.drawfeatureCtrl=null;this.navigation.activate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==RULER){fa="polyline";this.drawfeatureCtrl=new Mapabc.Control.Measure(l,Mapabc.Handler.Path,{persist:true,handlerOptions:{layerOptions:{styleMap:new Mapabc.StyleMap({"default":c})}}});this.navigation.deactivate();this.drawfeatureCtrl.events.on({movepoint:ya,measure:za,measurepartial:Aa});if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==
COMPUTE_AREA){fa="polygon";this.drawfeatureCtrl=new Mapabc.Control.Measure(l,Mapabc.Handler.Polygon);this.drawfeatureCtrl.events.on({movepoint:ya,measure:za,measurepartial:Aa});this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==FRAME_ZOOMIN){this.drawfeatureCtrl=new Mapabc.Control.ZoomBox({alwaysZoom:true});this.drawfeatureCtrl.out=false;this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}else if(a==
FRAME_ZOOMOUT){this.drawfeatureCtrl=new Mapabc.Control.ZoomBox({alwaysZoom:true});this.drawfeatureCtrl.out=true;this.navigation.deactivate();if(!ISSTOP_HADLEMEASUR){l.removeFeatures(B);ISSTOP_HADLEMEASUR=true}}if(this.drawfeatureCtrl!=null){this.map.addControl(this.drawfeatureCtrl,null);this.drawfeatureCtrl.activate()}a=this.getCtrlPanelState(OVERVIEW_CTRL);if(a=="show")document.getElementById("Attribution").style.right="180px";else if(a=="mini")document.getElementById("Attribution").style.right=
"40px"};var B,T=[],N=[];g.prototype.addOverlay=function(a,c){this.getOverlayById(a.id)&&this.removeOverlayById(a.id);a.id=String(a.id);var b=null;if(a instanceof w||a instanceof U){this.addMarker(a,c);if(b=Mapabc.Util.getElement(a.id)){a.size=new Q(b.offsetWidth,b.offsetHeight);b.oncontextmenu=function(){return false};a.TYPE!=i.TYPE_GROUNDIMAGE&&(new Mapabc.Events(this,b,null,true)).on({mousedown:this.map.onmousedown,mousemove:this.map.onmousemove,mouseup:this.map.onmouseup,mouseout:this.map.onmouseout,
contextmenu:this.map.oncontextmenu,click:this.map.onclick,scope:this})}}else if(a instanceof I){this.addPolyline(a,c);b=Mapabc.Util.getElement(a.id)}else if(a instanceof K){this.addPolygon(a,c);b=Mapabc.Util.getElement(a.id)}else if(a instanceof J){this.addRectangle(a,c);b=Mapabc.Util.getElement(a.id)}else if(a instanceof G){this.addCircle(a,c);b=Mapabc.Util.getElement(a.id)}else if(a instanceof O)this.addLabel(a,c);else a instanceof E&&this.addBox(a,c);a.option.isEditable&&!(a instanceof G)&&this.modifyctrl.modifyfeatureArrById.push(a.id);
this.isoverlayofmenu||this.addMenuItems();if(a.option.isEditable){this.modifyctrl.deactivate();this.modifyctrl.activate()}else{b=this.modifyctrl.modifyfeatureArrById.length;for(var d=0;d<b;d++)if(this.modifyctrl.modifyfeatureArrById[d]==a.id){this.modifyctrl.modifyfeatureArrById.splice(d,1);this.modifyctrl.deactivate()}}this.addEventListener(a,MOUSE_UP,sa)};Array.prototype.in_array=function(a){for(var c=0,b=this.length;c<b;c++)if(this[c].id==a.id){if(a.overlay instanceof w)C.removeMarker(this[c].vector);
else a.overlay instanceof O?C.removeLabel(this[c].vector):l.removeFeatures(this[c].vector);this.splice(c,1);this.push(a);return false}this.push(a);return true};g.prototype.addOverlays=function(a,c){var b=[],d=null,e,f=null;e=0;for(var n=a.length;e<n;e++){a[e].id=String(a[e].id);this.getOverlayById(a[e].id)&&this.removeOverlayById(a[e].id);if(a[e]instanceof w||a[e]instanceof U){if(a[e]){var h=k(a[e].lnglat);if(c)f=new Mapabc.Bounds(h.lon,h.lat,h.lon,h.lat)}this.addMarker(a[e],false);h=Mapabc.Util.getElement(a[e].id);
a[e].size=new Q(h.offsetWidth,h.offsetHeight);if(h){h.oncontextmenu=function(){return false};a[e].TYPE!=i.TYPE_GROUNDIMAGE&&(new Mapabc.Events(this,h,null,true)).on({mousedown:this.map.onmousedown,mousemove:this.map.onmousemove,mouseup:this.map.onmouseup,mouseout:this.map.onmouseout,contextmenu:this.map.oncontextmenu,click:this.map.onclick,scope:this})}this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof I){b.push(ra(a[e]));h={};h.id=a[e].id;h.vector=b[b.length-
1];h.overlay=a[e];if(this.returnCoordType==COORD_TYPE_ENCODE)for(var o=0;o<h.overlay.lnglatArr.length;o++)if(!isNaN(h.overlay.lnglatArr[o].lngX)||!isNaN(h.overlay.lnglatArr[o].latY)){h.overlay.lnglatArr[o].lngX=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].lngX,0);h.overlay.lnglatArr[o].latY=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].latY,0)}this.lineList.in_array(h);if(c)f=h.vector.geometry.getBounds();this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof
K){b.push(qa(a[e]));h={};h.id=a[e].id;h.vector=b[b.length-1];h.overlay=a[e];if(this.returnCoordType==COORD_TYPE_ENCODE)for(o=0;o<h.overlay.lnglatArr.length;o++)if(!isNaN(h.overlay.lnglatArr[o].lngX)||!isNaN(h.overlay.lnglatArr[o].latY)){h.overlay.lnglatArr[o].lngX=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].lngX,0);h.overlay.lnglatArr[o].latY=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].latY,0)}this.polygonList.in_array(h);if(c)f=h.vector.geometry.getBounds();this.addEventListener(a[e],MOUSE_UP,
this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof J){b.push(pa(a[e]));h={};h.id=a[e].id;h.vector=b[b.length-1];h.overlay=a[e];if(this.returnCoordType==COORD_TYPE_ENCODE)for(o=0;o<h.overlay.lnglatArr.length;o++)if(!isNaN(h.overlay.lnglatArr[o].lngX)||!isNaN(h.overlay.lnglatArr[o].latY)){h.overlay.lnglatArr[o].lngX=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].lngX,0);h.overlay.lnglatArr[o].latY=Mapabc.Util.encodeNumber(h.overlay.lnglatArr[o].latY,0)}this.rectList.in_array(h);if(c)f=h.vector.geometry.getBounds();
this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof G){if(a[e].option.isEditable)a[e].option.isEditable=false;var D=oa(a[e]);b.push(D);h={};h.id=a[e].id;h.vector=b[b.length-1];h.overlay=a[e];if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(h.overlay.center.lngX)||!isNaN(h.overlay.center.latY)){h.overlay.center.lngX=Mapabc.Util.encodeNumber(h.overlay.center.lngX,0);h.overlay.center.latY=Mapabc.Util.encodeNumber(h.overlay.center.latY,0)}this.circeList.in_array(h);
o=p(new Mapabc.LonLat(D.geometry.getBounds().left,D.geometry.getBounds().bottom));D=p(new Mapabc.LonLat(D.geometry.getBounds().right,D.geometry.getBounds().top));o=new R(new z(o.lngX,o.latY),new z(D.lngX,D.latY));if(this.map.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(o.southWest.lngX)||!isNaN(o.northEast.lngX)||!isNaN(o.southWest.lngY)||!isNaN(o.northEast.latY)){o.southWest.lngX=Mapabc.Util.encodeNumber(o.southWest.lngX,0);o.southWest.latY=Mapabc.Util.encodeNumber(o.southWest.latY,0);o.northEast.lngX=
Mapabc.Util.encodeNumber(o.northEast.lngX,0);o.northEast.latY=Mapabc.Util.encodeNumber(o.northEast.latY,0)}a[e].bounds=o;if(c)f=h.vector.geometry.getBounds();this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof O){if(a[e]){h=k(a[e].lnglat);if(c)f=new Mapabc.Bounds(h.lon,h.lat,h.lon,h.lat)}this.addLabel(a[e]);this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}else if(a[e]instanceof E){if(a[e]){h=k(a[e].lnglat);if(c)f=new Mapabc.Bounds(h.lon,
h.lat,h.lon,h.lat)}this.addBox(a[e],false);this.addEventListener(a[e],MOUSE_UP,this.map._MMAPABC_EVENT_MOUSEUP_)}a[e]&&a[e].option&&a[e].option.isEditable&&this.modifyctrl.modifyfeatureArrById.push(a[e].id);if(c)if(d==null)d=f;else d.extend(f)}this.modifyctrl.activate();l.addFeatures(b);if(a.length!=1)c&&this.map.zoomToExtent(d,false,0);else if(a[0]instanceof w||a[0]instanceof U||a[0]instanceof E){if(c){if(isNaN(a[0].lnglat.lngX)||isNaN(a[0].lnglat.latY))a[0].lnglat=Mapabc.Util.getCoord(a[0].lnglat);
this.map.setCenter(k(a[0].lnglat))}}else c&&this.map.zoomToExtent(d,false,0)};g.prototype.addBox=function(a,c){var b=k(a.lnglat),d=[a.lnglat.lngX,50,3,a.lnglat.latY];d=new Mapabc.Bounds(d[0],d[1],d[2],d[3]);b=new Mapabc.Marker.Box(b,d);b.zIndex=a.option.zIndex_option;b.content=a.option.content;b.boxAlign=a.option.boxAlign;b.id=a.id;P.box=b;P.addMarker(b);d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(d.overlay.lnglat.lngX)||!isNaN(d.overlay.lnglat.latY)){d.overlay.lnglat.lngX=
Mapabc.Util.encodeNumber(d.overlay.lnglat.lngX,0);d.overlay.lnglat.latY=Mapabc.Util.encodeNumber(d.overlay.lnglat.latY,0)}this.boxList.in_array(d);a.option.isEditable&&this.addEventListener(a,MOUSE_DOWN,la);c&&this.map.zoomToExtent(b.getBounds(),false,-1);d={};d.mapId=this.map.id;d.type="featureadded";d.feature=b;L(d)};g.prototype.addLabel=function(a,c){if(!a.option)a.option=new na;var b=a.option,d=b.anchor;b.anchor&&new Mapabc.Pixel(d.x,d.y);b={id:a.id,content:b.content,fontColor:x(b.fontStyle.color),
fontSize:b.fontStyle.size,fontFamily:b.fontStyle.name,fontWeight:b.fontStyle.bold,alpha:b.alpha,hasBackground:b.hasBackground,hasBorder:b.hasBorder,backgroundColor:x(b.backgroundColor),borderColor:x(b.borderColor),labelAlign:b.labelAlign,labelPosition:b.labelPosition};d=k(a.lnglat);b=new Mapabc.Label(d,b);b.update=a.update;d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(d.overlay.lnglat.lngX)||!isNaN(d.overlay.lnglat.latY)){d.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(d.overlay.lnglat.lngX,
0);d.overlay.lnglat.latY=Mapabc.Util.encodeNumber(d.overlay.lnglat.latY,0)}this.labelList.in_array(d);C.addLabel(b);c&&this.map.zoomToExtent(b.getBounds(),false,-1)};g.prototype.getLngLatByOffset=function(a,c,b,d){d||(d=6378137);a=Ba(a,c,b,d);if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(a.lngX)||!isNaN(a.latY)){a.lngX=Mapabc.Util.encodeNumber(a.lngX,0);a.latY=Mapabc.Util.encodeNumber(a.latY,0)}return a};g.prototype.addCircle=function(a,c){if(!a.option.isEditable)a.option.isEditable=true;a.center.lngX=
Number(a.center.lngX);a.center.latY=Number(a.center.latY);var b=oa(a);b.update=a.update;var d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(d.overlay.center.lngX)||!isNaN(d.overlay.center.latY)){d.overlay.center.lngX=Mapabc.Util.encodeNumber(d.overlay.center.lngX,0);d.overlay.center.latY=Mapabc.Util.encodeNumber(d.overlay.center.latY,0)}var e=p(new Mapabc.LonLat(b.geometry.getBounds().left,b.geometry.getBounds().bottom)),f=p(new Mapabc.LonLat(b.geometry.getBounds().right,
b.geometry.getBounds().top));e=new R(new z(e.lngX,e.latY),new z(f.lngX,f.latY));if(this.map.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(e.southWest.lngX)||!isNaN(e.northEast.lngX)||!isNaN(e.southWest.lngY)||!isNaN(e.northEast.latY)){e.southWest.lngX=Mapabc.Util.encodeNumber(e.southWest.lngX,0);e.southWest.latY=Mapabc.Util.encodeNumber(e.southWest.latY,0);e.northEast.lngX=Mapabc.Util.encodeNumber(e.northEast.lngX,0);e.northEast.latY=Mapabc.Util.encodeNumber(e.northEast.latY,0)}a.bounds=e;d.overlay.bounds=
e;this.circeList.in_array(d);l.addFeatures([b]);if(c){e=b.geometry.getBounds();this.map.zoomToExtent(e,false,-1)}if(a.option.isRotate){d=a.option.rotateCenter?new H(k(a.option.rotateCenter).lon,k(a.option.rotateCenter).lat):b.geometry.getCentroid();b.geometry.rotate(a.option.rotation,d);b.layer.drawFeature(b)}};g.prototype.addRectangle=function(a,c){var b=pa(a);b.update=a.update;var d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)for(var e=0;e<d.overlay.lnglatArr.length;e++)if(!isNaN(d.overlay.lnglatArr[e].lngX)||
!isNaN(d.overlay.lnglatArr[e].latY)){d.overlay.lnglatArr[e].lngX=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].lngX,0);d.overlay.lnglatArr[e].latY=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].latY,0)}this.rectList.in_array(d);l.addFeatures([b]);c&&this.map.zoomToExtent(b.geometry.getBounds(),false)};g.prototype.addPolygon=function(a,c){var b=qa(a);b.update=a.update;var d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)for(var e=0;e<d.overlay.lnglatArr.length;e++)if(!isNaN(d.overlay.lnglatArr[e].lngX)||
!isNaN(d.overlay.lnglatArr[e].latY)){d.overlay.lnglatArr[e].lngX=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].lngX,0);d.overlay.lnglatArr[e].latY=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].latY,0)}this.polygonList.in_array(d);l.addFeatures(b);c&&this.map.zoomToExtent(b.geometry.getBounds(),false,-1);if(a.option.isRotate){d=a.option.rotateCenter?new H(k(a.option.rotateCenter).lon,k(a.option.rotateCenter).lat):b.geometry.getCentroid();b.geometry.rotate(a.option.rotation,d);b.layer.drawFeature(b)}};
g.prototype.addPolyline=function(a,c){var b=ra(a);b.update=a.update;var d={};d.id=a.id;d.vector=b;d.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)for(var e=0;e<d.overlay.lnglatArr.length;e++)if(!isNaN(d.overlay.lnglatArr[e].lngX)||!isNaN(d.overlay.lnglatArr[e].latY)){d.overlay.lnglatArr[e].lngX=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].lngX,0);d.overlay.lnglatArr[e].latY=Mapabc.Util.encodeNumber(d.overlay.lnglatArr[e].latY,0)}this.lineList.in_array(d);l.addFeatures(b);c&&this.map.zoomToExtent(b.geometry.getBounds(),
false);if(a.option.isRotate){d=a.option.rotateCenter?new H(k(a.option.rotateCenter).lon,k(a.option.rotateCenter).lat):b.geometry.components[Math.round(b.geometry.components.length/2-1)];b.geometry.rotate(a.option.rotation,d);b.layer.drawFeature(b)}};var s=null,Ka;g.prototype.addMarker=function(a,c){if(!a.option)a.option=this.markerOptions;var b=a.option,d=b.imageSize;if(d)d=new Mapabc.Size(parseInt(d.width),parseInt(d.height));var e=b.anchor;if(b.anchor)e=new Mapabc.Pixel(e.x,e.y);var f=b.labelOption?
{content:b.labelOption.content,fontColor:x(b.labelOption.fontStyle.color),fontSize:b.labelOption.fontStyle.size,fontFamily:b.labelOption.fontStyle.name,fontWeight:b.labelOption.fontStyle.bold,alpha:b.labelOption.alpha,hasBackground:b.labelOption.hasBackground,hasBorder:b.labelOption.hasBorder,backgroundColor:x(b.labelOption.backgroundColor),borderColor:x(b.labelOption.borderColor),labelAlign:b.labelOption.labelAlign,labelPosition:b.labelOption.labelPosition}:null;d=new Mapabc.Icon(b.imageUrl,d,e);
if(isNaN(a.lnglat.lngX)||isNaN(a.lnglat.latY))a.lnglat=Mapabc.Util.getCoord(a.lnglat);b=k(a.lnglat);e=new Mapabc.Marker(b,d,{offset:e,labelOption:f,id:a.id,zIndex:a.option.zIndex_option,overlay:a});e.isTriggerEvent=a.isTriggerEvent;f={};f.id=a.id;f.vector=e;f.overlay=a;if(this.returnCoordType==COORD_TYPE_ENCODE)if(!isNaN(f.overlay.lnglat.lngX)||!isNaN(f.overlay.lnglat.latY)){f.overlay.lnglat.lngX=Mapabc.Util.encodeNumber(f.overlay.lnglat.lngX,0);f.overlay.lnglat.latY=Mapabc.Util.encodeNumber(f.overlay.lnglat.latY,
0)}a instanceof U?this.groundImagesList.in_array(f):this.markerList.in_array(f);C.addMarker(e);a.option.canShowTip&&e.events.register("click",e,ka);a.option.isEditable&&this.addEventListener(a,MOUSE_DOWN,la);a.option.rotation&&e.rotate(a.option.rotation);c&&this.map.setCenter(b)};g.prototype.openTip=function(a,c){if(a!=null&&c!=null){a=k(a);$("",a,c,true,true)}};g.prototype.closeTip=function(a){if(s)if(s.overlayType==a||a==undefined)s.hide();else if(s.div.getAttribute("jsoverlayid")==a||a==undefined)s.hide()};
g.prototype.openOverlayTip=function(a){var c=this.getOverlayById(a,"overlay"),b=this.getOverlayById(a,"vector");if(c!=null&&b!=null){var d=c.option;if(d.canShowTip)if(c instanceof w){b=Mapabc.Util.getElement(a);if(isNaN(c.lnglat.lngX)||isNaN(c.lnglat.latY))c.lnglat=Mapabc.Util.getCoord(c.lnglat);if(!c.option.anchor)c.option.anchor=new H(0,0);d=k(c.lnglat);var e={};e.width=parseInt(b.offsetWidth);e.height=parseInt(b.offsetHeight);e.map=this.map;e.anchor=c.option.anchor;e.imageAlign=c.option.imageAlign;
$(a,d,c.option.tipOption,true,true,e)}else{b.geometry.calculateBounds();if(c instanceof G){a=isNaN(c.center.lngX)||isNaN(c.center.latY)?Mapabc.Util.getCoord(c.center):c.center;a=k(a)}else{if(isNaN(c.lnglatArr[1].lngX)||isNaN(c.lnglatArr[1].latY))c.lnglatArr[1]=Mapabc.Util.getCoord(c.lnglatArr[1]);a=k(c.lnglatArr[1])}$(b.id,a,d.tipOption,true,true)}}};g.prototype.setOverlayToTopById=function(a){if(a){var c=this.getOverlayById(a);if(c){var b=true;if(!this.getOverlayVisibleById(a)){b=false;this.setOverlayVisibleById(a,
true)}if(c instanceof w){for(var d=0,e=this.markerList.length;d<e;d++){this.markerList[d].overlay.option.zIndex_option=this.markerList[d].overlay.id==c.id?1:0;this.updateOverlay(this.markerList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof E){d=0;for(e=this.boxList.length;d<e;d++){this.boxList[d].overlay.option.zIndex_option=this.boxList[d].overlay.id==c.id?1:0;this.updateOverlay(this.boxList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof
U){d=0;for(e=this.groundImagesList.length;d<e;d++){this.groundImagesList[d].overlay.option.zIndex_option=this.groundImagesList[d].overlay.id==c.id?1:0;this.updateOverlay(this.groundImagesList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof O){d=0;for(e=this.labelList.length;d<e;d++){this.labelList[d].overlay.option.zIndex_option=this.labelList[d].overlay.id==c.id?1:0;this.updateOverlay(this.labelList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof
I){d=0;for(e=this.lineList.length;d<e;d++){this.lineList[d].overlay.option.zIndex_option=this.lineList[d].overlay.id==c.id?1:0;this.updateOverlay(this.lineList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof K){d=0;for(e=this.polygonList.length;d<e;d++){this.polygonList[d].overlay.option.zIndex_option=this.polygonList[d].overlay.id==c.id?1:0;this.updateOverlay(this.polygonList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof J){d=0;
for(e=this.rectList.length;d<e;d++){this.rectList[d].overlay.option.zIndex_option=this.rectList[d].overlay.id==c.id?1:0;this.updateOverlay(this.rectList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}else if(c instanceof G){d=0;for(e=this.circeList.length;d<e;d++){this.circeList[d].overlay.option.zIndex_option=this.circeList[d].overlay.id==c.id?1:0;this.updateOverlay(this.circeList[d].overlay)}b||this.setOverlayVisibleById(a,false);return 0}}else return-1}else return-1};g.prototype.removeMenuItems=
function(a,c){var b=false;if(a instanceof Array)for(var d=0;d<a.length;d++){if(String(a[d])!="version"||c){for(var e=0;e<this.menuItemsObj_map.length;e++)if(String(this.menuItemsObj_map[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_map,this.menuItemsObj_map[e]);b=true}for(e=0;e<this.menuItemsObj_marker.length;e++)if(String(this.menuItemsObj_marker[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_marker,this.menuItemsObj_marker[e]);b=true}for(e=0;e<
this.menuItemsObj_box.length;e++)if(String(this.menuItemsObj_box[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_box,this.menuItemsObj_box[e]);b=true}for(e=0;e<this.menuItemsObj_polyline.length;e++)if(String(this.menuItemsObj_polyline[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_polyline,this.menuItemsObj_polyline[e]);b=true}for(e=0;e<this.menuItemsObj_polygon.length;e++)if(String(this.menuItemsObj_polygon[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_polygon,
this.menuItemsObj_polygon[e]);b=true}for(e=0;e<this.menuItemsObj_rect.length;e++)if(String(this.menuItemsObj_rect[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_rect,this.menuItemsObj_rect[e]);b=true}for(e=0;e<this.menuItemsObj_circle.length;e++)if(String(this.menuItemsObj_circle[e].menuItem.id)==String(a[d])){Mapabc.Util.removeItem(this.menuItemsObj_circle,this.menuItemsObj_circle[e]);b=true}if(this.menu){var f=this.menu.childNodes;for(e=0;e<f.length;e++)if(String(f[e].id)==
String(a[d])){var n=Mapabc.Util.getElement(f[e].id);if(n){this.menu.removeChild(n);b=true}}f.length==0&&da()}}}else if(a)if(String(a)!="version"||c){for(e=0;e<this.menuItemsObj_map.length;e++)if(String(this.menuItemsObj_map[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_map,this.menuItemsObj_map[e]);b=true}for(e=0;e<this.menuItemsObj_marker.length;e++)if(String(this.menuItemsObj_marker[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_marker,this.menuItemsObj_marker[e]);
b=true}for(e=0;e<this.menuItemsObj_box.length;e++)if(String(this.menuItemsObj_box[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_box,this.menuItemsObj_box[e]);b=true}for(e=0;e<this.menuItemsObj_polyline.length;e++)if(String(this.menuItemsObj_polyline[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_polyline,this.menuItemsObj_polyline[e]);b=true}for(e=0;e<this.menuItemsObj_polygon.length;e++)if(String(this.menuItemsObj_polygon[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_polygon,
this.menuItemsObj_polygon[e]);b=true}for(e=0;e<this.menuItemsObj_rect.length;e++)if(String(this.menuItemsObj_rect[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_rect,this.menuItemsObj_rect[e]);b=true}for(e=0;e<this.menuItemsObj_circle.length;e++)if(String(this.menuItemsObj_circle[e].menuItem.id)==String(a)){Mapabc.Util.removeItem(this.menuItemsObj_circle,this.menuItemsObj_circle[e]);b=true}if(this.menu){f=this.menu.childNodes;for(e=0;e<f.length;e++)if(String(f[e].id)==String(a[d]))if(n=
Mapabc.Util.getElement(f[e].id)){this.menu.removeChild(n);b=true}}}return b};g.prototype.addMenuItems=function(a){if(a){this.selectSort(a);this.addMenuitemlogarr.push(a);return this.execAddMenuItems(a)}else{a=this.addMenuitemlogarr.length;for(var c=0;c<a;c++)this.addMenuitemlogarr[c]&&this.execAddMenuItems(this.addMenuitemlogarr[c])}};g.prototype.execAddMenuItems=function(a){if(a.length!=0)for(var c in a)this.removeMenuItems(a[c].id,true);this.menuItemsIds=[];c=a.length;var b=null;if(c!=0)for(var d=
0;d<c;d++){a[d].id=a[d].id!=""&&a[d].id?a[d].id:d+1+"menuItem";var e={};e.menuItem=a[d];e.overlayIds=a[d].overlayIds;e.type=a[d].objectType;if(e.type==TYPE_MAP){this.menuItemsObj_map.push(e);this.addEventListener(this,MOUSE_RIGHT_CLICK,this.menuItemForMap)}else if(e.type==i.TYPE_MARKER){this.menuItemsObj_marker.push(e);b=i.TYPE_MARKER}else if(e.type==i.TYPE_MBOX){this.menuItemsObj_box.push(e);b=i.TYPE_MBOX}else if(e.type==i.TYPE_POLYLINE){this.menuItemsObj_polyline.push(e);b=i.TYPE_POLYLINE}else if(e.type==
i.TYPE_POLYGON){this.menuItemsObj_polygon.push(e);b=i.TYPE_POLYGON}else if(e.type==i.TYPE_RECTANGLE){this.menuItemsObj_rect.push(e);b=i.TYPE_RECTANGLE}else if(e.type==i.TYPE_CIRCLE){this.menuItemsObj_circle.push(e);b=i.TYPE_CIRCLE}this.menuItemsIds.push(a[d].id);this.register(b)}return this.menuItemsIds};g.prototype.register=function(a){if(a){if(a==i.TYPE_MARKER)var c=this.getOverlaysByType(i.TYPE_MARKER);if(a==i.TYPE_MBOX)c=this.getOverlaysByType(i.TYPE_MBOX);if(a==i.TYPE_POLYLINE)c=this.getOverlaysByType(i.TYPE_POLYLINE);
if(a==i.TYPE_POLYGON)c=this.getOverlaysByType(i.TYPE_POLYGON);if(a==i.TYPE_RECTANGLE)c=this.getOverlaysByType(i.TYPE_RECTANGLE);if(a==i.TYPE_CIRCLE)c=this.getOverlaysByType(i.TYPE_CIRCLE);if(c=="")this.isoverlayofmenu=false;else for(a=0;a<c.length;a++)if(c[a]instanceof w){var b=this.getOverlayById(c[a].id,"vector");b.events.register(MOUSE_RIGHT_CLICK,b,this.menuItemForOverlay)}else this.addEventListener(c[a],MOUSE_RIGHT_CLICK,this.menuItemForOverlay)}};g.prototype.menuItemForMap=function(a){a=Da(a);
m.menuItems=[];for(var c=m.menuItemsObj_map.length,b=[],d=0;d<c;d++){var e=m.menuItemsObj_map[d].menuItem;if(e.id!="version"){if(e.objectType==TYPE_MAP&&a.overlay==null){var f={};f.id=e.id;f.menuText=e.menuText;f.functionName=e.functionName;f.objectType=TYPE_MAP;f.overlayId=a.overlayId;f.isEnabled=e.isEnabled;f.isHaveSeparator=e.isHaveSeparator;m.menuItems.push(f)}}else{f={};f.id=e.id;f.menuText=e.menuText;f.functionName=e.functionName;f.objectType=TYPE_MAP;f.overlayId=a.overlayId;f.isEnabled=e.isEnabled;
f.isHaveSeparator=e.isHaveSeparator;b.push(f)}}c=0;for(d=b.length;c<d;c++)m.menuItems.push(b[c]);m.createMenuDiv(m.menuItems,a.lnglat)};g.prototype.menuItemForOverlay=function(a){a=Da(a);if(a.overlay instanceof w)aa(a,m.menuItemsObj_marker);else if(a.overlay instanceof E)aa(a,m.menuItemsObj_box);else if(a.overlay instanceof I)aa(a,m.menuItemsObj_polyline);else if(a.overlay instanceof K)aa(a,m.menuItemsObj_polygon);else if(a.overlay instanceof J)aa(a,m.menuItemsObj_rect);else a.overlay instanceof G&&
aa(a,m.menuItemsObj_circle)};g.prototype.createMenuDiv=function(a,c){m.menu&&da();if(isNaN(c.lngX)||isNaN(c.latY))c=Mapabc.Util.getCoord(c);var b=m.fromLngLatToContainerPixel(c);m.menu=Mapabc.Util.createDiv(null,null,null,null,"absolute");m.menu.className="dropdownmenu";for(var d=a.length,e=0;e<d;e++){var f=Mapabc.Util.createDiv(a[e].id,null,null,null,"relative");f.className="menuitem";var n=document.createElement("a");if(a[e].isEnabled){n.onclick=a[e].functionName;n.setAttribute("href","#");if(Mapabc.Util.getBrowserName()==
"msie"||Mapabc.Util.getBrowserName()=="safari")n.innerText=a[e].menuText;else if(Mapabc.Util.getBrowserName()=="firefox")n.textContent=a[e].menuText;n.style.color="#000";var h=a[e].objectType,o=a[e].overlayId;(new Mapabc.Events(m,f,null,true)).on({mousedown:q.onmousedown,mouseup:q.onmouseup,click:function(){var D={};D.type="menuItemclick";D.mapId=m.map.id;D.menuItemId=document.all?window.event.srcElement.parentNode.id:F.target.parentNode.id;D.objectType=h;D.overlayId=o;D.xy=c;L(D);V(D);Mapabc.Event.stop(D,
true)},scope:this})}else{n.setAttribute("href","#");n.disabled=a[e].isEnabled;if(Mapabc.Util.getBrowserName()=="msie")n.innerText=a[e].menuText;else if(Mapabc.Util.getBrowserName()=="firefox")n.textContent=a[e].menuText;n.style.color="#666"}f.appendChild(n);if(a[e].isHaveSeparator)if(a[e].id!="version"){n.style.borderLeft="0px";n.style.borderBottom="#ccc 1px solid"}else{n.style.borderLeft="0px";n.style.borderTop="#444444 1px solid"}n.style.fontFamily="Arial,\u5b8b\u4f53";m.menu.appendChild(f)}if(m.menu.childNodes.length!=
0){this.map.viewPortDiv.appendChild(m.menu);e=m.getSize().width;f=m.getSize().height;d=m.menu.offsetWidth;n=m.menu.offsetHeight;if(b.x>e-d&&b.y>f-n){m.menu.style.left=b.x-d+"px";m.menu.style.top=b.y-n+"px"}else if(b.x>e-d){m.menu.style.left=b.x-d+"px";m.menu.style.top=b.y+"px"}else if(b.y>f-n){m.menu.style.left=b.x+"px";m.menu.style.top=b.y-n+"px"}else{m.menu.style.left=b.x+"px";m.menu.style.top=b.y+"px"}b=0;for(e=m.menu.childNodes.length;b<e;b++)m.menu.childNodes[b].childNodes[0].style.width=d+"px"}};
g.prototype.selectSort=function(a){for(var c,b=0;b<a.length;b++){var d=b;for(c=b+1;c<a.length;c++){if(a[c].order=="")a[c].order=c+a.length;if(a[d].order=="")a[d].order=c+1;if(a[c].order<a[d].order)d=c}if(d!=b){c=a[b];a[b]=a[d];a[d]=c}}return a};g.prototype.magnifyingglassForMap=function(){var a=Mapabc.Util.createDiv("map_magnifyingglass");a.style.borderRight="medium none";a.style.borderTop="medium none";a.style.borderLeft="medium none";a.style.borderBottom="medium none";a.style.width="111px";a.style.height=
"74px";a.style.display="none";a.style.unselectable="on";var c=Mapabc.Util.createDiv();c.style.lineHeight="1px";c.style.width="4px";c.style.height="4px";c.style.left="0";var b=Mapabc.Util.createDiv();b.style.lineHeight="1px";b.style.width="4px";b.style.height="4px";b.style.right="0";var d=Mapabc.Util.createDiv();d.style.lineHeight="1px";d.style.width="4px";d.style.height="4px";d.style.right="0";d.style.top="40px";var e=Mapabc.Util.createDiv();e.style.lineHeight="1px";e.style.width="4px";e.style.height=
"4px";e.style.left="0";e.style.top="40px";a.appendChild(c);a.appendChild(b);a.appendChild(d);a.appendChild(e);this.map.viewPortDiv.appendChild(a)};g.prototype.getTileUrlByLngLat=function(a){if(a instanceof z)return(a=this.map.baseLayer.getTitledByXY(k(a)))?a.url:null;else if(a instanceof Array){for(var c=0,b=a.length;c<b;c++)if(isNaN(a[c].lngX)||isNaN(a[c].latY))a[c]=Mapabc.Util.getCoord(a[c]);return a=this.map.baseLayer.getTilesByBounds(new Mapabc.Bounds(k(a[0]).lon,k(a[1]).lat,k(a[1]).lon,k(a[0]).lat))}else return null};
g.prototype.getTilesPosition=function(){alert(l.positionArray)};g.prototype.saveMap2JPG=function(){initFP_();var a=this;setTimeout(function(){var c=a.getCenter(),b=17-a.getZoomLevel(),d=a.getSize(),e=Mapabc_search_address[0]+"highLight=false&enc=utf-8&ver=2.0";e+="&config=WMAP&ver=2.0&cenX="+c.lngX+"&cenY="+c.latY+"&maplevel="+b+"&width="+d.width+"&height="+d.height+"&enc=utf-8&resType=JSON&a_k="+v("ame.js");c=new MAjaxRequest;c.setResponseHandler(a.aa,a);c.sendPostRequest(e,null,null,null)})};g.prototype.aa=
function(){alert(1234)};g.prototype.addControl=function(a){this.map.viewPortDiv.appendChild(a)};g.prototype.addDomListener=function(a,c,b){var d=this;a=new Mapabc.Events(this,a,null,true,{includeXY:true});var e={};e.type=c;e.functionName=b;a.on_dom(e);a.on({dblclick:d.map.ondblclick,mousedown:d.map.onmousedown,mousemove:d.map.onmousemove,mouseout:d.map.onmouseout,mouseover:function(){d.map.events.unregister(MOUSE_MOVING,this.map,this.map._MMAPABC_EVENT_MOUSEMOVE_)},contextmenu:d.map.oncontextmenu,
click:d.map.onclick})};g.prototype.getProjectPath=function(){return Mapabc._getScriptLocation()};var r=[],j=[];g.prototype.OverlayIdList=[];g.prototype.addEventListener=function(a,c,b){if(a){var d=true,e=true;if(a instanceof g){for(var f=0,n=r.length;f<n;f++)if(r[f].type==c&&r[f].obj==a.map){d=false;if(r[f].func==b){e=false;break}}if(d)if(c.indexOf("feature")!=-1){C.events.register(c,a.map,L);l.events.register(c,a.map,L)}else c.indexOf("dblclick")!=-1?l.events.register(c,a.map,L):a.map.events.register(c,
a.map,L);if(e){e={};e.func=b;e.obj=a.map;e.mapObj=a;e.type=c;e.id=a.id;r.push(e)}}else if(a instanceof w||a instanceof E||a instanceof O){f=0;for(n=j.length;f<n;f++)if(j[f].type==c&&j[f].id==a.id){d=false;if(j[f].func==b){e=false;break}}if(d)if(a instanceof w||a instanceof O){d=this.getOverlayById(a.id,"vector");d.events.register(c,d,V)}else if(a instanceof E){d=this.getOverlayById(a.id,"vector");P.box.events.register(c,d,V)}if(e){e={};e.func=b;e.obj=a;e.type=c;e.id=a.id;j.push(e)}}else if(!(c==MOUSE_OVER||
c==MOUSE_OUT)||!(a instanceof G)){f=0;for(n=j.length;f<n;f++)if(j[f].type==c){d=false;if(j[f].func==b&&j[f].id==a.id){e=false;break}}d&&l.events.register(c,a,V);if(e){e={};e.func=b;e.obj=a;e.type=c;e.id=a.id;j.push(e)}}}};g.prototype.removeEventListener=function(a,c){if(c=="popupopen"||c=="popupclose")c="click";if(a instanceof g){c.indexOf("feature")!=-1?l.events.unregister(c,a.map,L):a.map.events.unregister(c,a.map,L);for(var b in r){if(r[b].type=="popupopen"||r[b].type=="popupclose")c=r[b].type;
r[b].obj==a.map&&r[b].type==c&&r[b].id==a.id&&r.splice(b,1)}}else{for(b in j)j[b]&&j[b].obj==a&&j[b].type==c&&j[b].id==a.id&&j.splice(b,1);if(a instanceof w){b=this.getOverlayById(a.id,"vector");b.events.unregister(c,b,V)}else if(a instanceof E){b=this.getOverlayById(a.id,"vector");P.box.events.unregister(c,b,V)}else l.events.unregister(c,a,V)}};g.prototype.removeEventListenerByOverlayId=function(){};(function(a,c){for(var b=0;b<c.length;++b){var d=c[b],e=d[1];if(d[0]){var f=(a&&/^[A-Z][A-Z_]*$/.test(d[0])&&
a.indexOf(".")==-1?a+"_"+d[0]:a+d[0]).split(".");if(f.length==1)window[f[0]]=e;else{for(var n=window,h=0;h<f.length-1;++h){var o=f[h];n[o]||(n[o]={});n=n[o]}n[f[f.length-1]]=e}}if(f=d[2])for(h=0;h<f.length;++h)e.prototype[f[h][0]]=f[h][1];if(d=d[3])for(h=0;h<d.length;++h)e[d[h][0]]=d[h][1]}})("",[["MMapOptions",u],["MMap",g],["MLabel",O],["MLabelOptions",na],["MLngLat",z],["MLngLats",wa],["MMarkerOptions",ba],["MTipOptions",ja],["MBoxOptions",xa],["MBox",E],["MMarker",w],["MGroundImage",U],["MGroundImageOptions",
function(){this.imageUrl="http://code.mapabc.com/images/lan_1.png";this.imageSize=null;this.zoomLevels=[];this.imageAlign=MIDDLE_CENTER;this.originalLevel=null;this.zIndex_option=0}],["MPoint",H],["MLineStyle",ea],["MPolygon",K],["MPolyline",I],["MAreaStyle",ha],["MFontStyle",Z],["MLineOptions",ca],["MAreaOptions",S],["MRectangle",J],["MCircle",G],["MFillStyle",ia],["MSize",Q],["MLngLatBounds",R],["MPixelBounds",M],["MOverlay",i],["MTileLayerOptions",function(){this.layerId=this.eid=this.tempId=this.userId=
this.tileUrl=null}],["MTileLayer",ma],["MMenuItem",Ea],["addpopup",$],["LonLatToMLngLat",p],["MLngLatToLonLat",k],["triggerEvent",L]])})();
